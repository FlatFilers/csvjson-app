// js/3rd/jQuery-File-Upload/js/vendor/jquery.ui.widget.js
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory);}else{factory(jQuery);}}(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler("remove");}catch(e){}}
_cleanData(elems);};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget;}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName);};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element);}
if(arguments.length){this._createWidget(options,element);}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return;}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments);},_superApply=function(args){return base.prototype[prop].apply(this,args);};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue;};})();});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto);});delete existingConstructor._childConstructors;}else{base._childConstructors.push(constructor);}
$.widget.bridge(name,constructor);};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value);}else{target[key]=value;}}}}
return target;};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'");}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance");}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false;}});}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init();}else{$.data(this,fullName,new object(options,this));}});}
return returnValue;};};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy();}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow);}
this._create();this._trigger("create",null,this._getCreateEventData());this._init();},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");},_destroy:$.noop,widget:function(){return this.element;},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options);}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]];}
key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key];}
curOption[key]=value;}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key];}
options[key]=value;}}
this._setOptions(options);return this;},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key]);}
return this;},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");}
return this;},enable:function(){return this._setOption("disabled",false);},disable:function(){return this._setOption("disabled",true);},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false;}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget();}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element);}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return;}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++;}
var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy);}else{element.bind(eventName,handlerProxy);}});},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName);},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments);}
var instance=this;return setTimeout(handlerProxy,delay||0);},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover");},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover");}});},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus");},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus");}});},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop];}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented());}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options};}
var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options};}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay);}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options);}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback);}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0]);}
next();});}};});}));
// js/3rd/jQuery-File-Upload/js/jquery.iframe-transport.js
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(window.jQuery);}}(function($){'use strict';var counter=0;$.ajaxTransport('iframe',function(options){if(options.async){var initialIframeSrc=options.initialIframeSrc||'javascript:false;',form,iframe,addParamChar;return{send:function(_,completeCallback){form=$('<form style="display:none;"></form>');form.attr('accept-charset',options.formAcceptCharset);addParamChar=/\?/.test(options.url)?'&':'?';if(options.type==='DELETE'){options.url=options.url+addParamChar+'_method=DELETE';options.type='POST';}else if(options.type==='PUT'){options.url=options.url+addParamChar+'_method=PUT';options.type='POST';}else if(options.type==='PATCH'){options.url=options.url+addParamChar+'_method=PATCH';options.type='POST';}
counter+=1;iframe=$('<iframe src="'+initialIframeSrc+'" name="iframe-transport-'+counter+'"></iframe>').bind('load',function(){var fileInputClones,paramNames=$.isArray(options.paramName)?options.paramName:[options.paramName];iframe.unbind('load').bind('load',function(){var response;try{response=iframe.contents();if(!response.length||!response[0].firstChild){throw new Error();}}catch(e){response=undefined;}
completeCallback(200,'success',{'iframe':response});$('<iframe src="'+initialIframeSrc+'"></iframe>').appendTo(form);window.setTimeout(function(){form.remove();},0);});form.prop('target',iframe.prop('name')).prop('action',options.url).prop('method',options.type);if(options.formData){$.each(options.formData,function(index,field){$('<input type="hidden"/>').prop('name',field.name).val(field.value).appendTo(form);});}
if(options.fileInput&&options.fileInput.length&&options.type==='POST'){fileInputClones=options.fileInput.clone();options.fileInput.after(function(index){return fileInputClones[index];});if(options.paramName){options.fileInput.each(function(index){$(this).prop('name',paramNames[index]||options.paramName);});}
form.append(options.fileInput).prop('enctype','multipart/form-data').prop('encoding','multipart/form-data');options.fileInput.removeAttr('form');}
form.submit();if(fileInputClones&&fileInputClones.length){options.fileInput.each(function(index,input){var clone=$(fileInputClones[index]);$(input).prop('name',clone.prop('name')).attr('form',clone.attr('form'));clone.replaceWith(input);});}});form.append(iframe).appendTo(document.body);},abort:function(){if(iframe){iframe.unbind('load').prop('src',initialIframeSrc);}
if(form){form.remove();}}};}});$.ajaxSetup({converters:{'iframe text':function(iframe){return iframe&&$(iframe[0].body).text();},'iframe json':function(iframe){return iframe&&$.parseJSON($(iframe[0].body).text());},'iframe html':function(iframe){return iframe&&$(iframe[0].body).html();},'iframe xml':function(iframe){var xmlDoc=iframe&&iframe[0];return xmlDoc&&$.isXMLDoc(xmlDoc)?xmlDoc:$.parseXML((xmlDoc.XMLDocument&&xmlDoc.XMLDocument.xml)||$(xmlDoc.body).html());},'iframe script':function(iframe){return iframe&&$.globalEval($(iframe[0].body).text());}}});}));
// js/3rd/jQuery-File-Upload/js/jquery.fileupload.js
(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','jquery.ui.widget'],factory);}else{factory(window.jQuery);}}(function($){'use strict';$.support.fileInput=!(new RegExp('(Android (1\\.[0156]|2\\.[01]))'+'|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)'+'|(w(eb)?OSBrowser)|(webOS)'+'|(Kindle/(1\\.0|2\\.[05]|3\\.0))').test(window.navigator.userAgent)||$('<input type="file">').prop('disabled'));$.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);$.support.xhrFormDataFileUpload=!!window.FormData;$.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);$.widget('blueimp.fileupload',{options:{dropZone:$(document),pasteZone:$(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,limitMultiFileUploadSize:undefined,limitMultiFileUploadSizeOverhead:512,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:'Uploaded bytes exceed file size'},i18n:function(message,context){message=this.messages[message]||message.toString();if(context){$.each(context,function(key,value){message=message.replace('{'+key+'}',value);});}
return message;},formData:function(form){return form.serializeArray();},add:function(e,data){if(e.isDefaultPrevented()){return false;}
if(data.autoUpload||(data.autoUpload!==false&&$(this).fileupload('option','autoUpload'))){data.process().done(function(){data.submit();});}},processData:false,contentType:false,cache:false},_specialOptions:['fileInput','dropZone','pasteZone','multipart','forceIframeTransport'],_blobSlice:$.support.blobSlice&&function(){var slice=this.slice||this.webkitSlice||this.mozSlice;return slice.apply(this,arguments);},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(now,loaded,interval){var timeDiff=now-this.timestamp;if(!this.bitrate||!interval||timeDiff>interval){this.bitrate=(loaded-this.loaded)*(1000/timeDiff)*8;this.loaded=loaded;this.timestamp=now;}
return this.bitrate;};},_isXHRUpload:function(options){return!options.forceIframeTransport&&((!options.multipart&&$.support.xhrFileUpload)||$.support.xhrFormDataFileUpload);},_getFormData:function(options){var formData;if($.type(options.formData)==='function'){return options.formData(options.form);}
if($.isArray(options.formData)){return options.formData;}
if($.type(options.formData)==='object'){formData=[];$.each(options.formData,function(name,value){formData.push({name:name,value:value});});return formData;}
return[];},_getTotal:function(files){var total=0;$.each(files,function(index,file){total+=file.size||1;});return total;},_initProgressObject:function(obj){var progress={loaded:0,total:0,bitrate:0};if(obj._progress){$.extend(obj._progress,progress);}else{obj._progress=progress;}},_initResponseObject:function(obj){var prop;if(obj._response){for(prop in obj._response){if(obj._response.hasOwnProperty(prop)){delete obj._response[prop];}}}else{obj._response={};}},_onProgress:function(e,data){if(e.lengthComputable){var now=((Date.now)?Date.now():(new Date()).getTime()),loaded;if(data._time&&data.progressInterval&&(now-data._time<data.progressInterval)&&e.loaded!==e.total){return;}
data._time=now;loaded=Math.floor(e.loaded/e.total*(data.chunkSize||data._progress.total))+(data.uploadedBytes||0);this._progress.loaded+=(loaded-data._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(now,this._progress.loaded,data.bitrateInterval);data._progress.loaded=data.loaded=loaded;data._progress.bitrate=data.bitrate=data._bitrateTimer.getBitrate(now,loaded,data.bitrateInterval);this._trigger('progress',$.Event('progress',{delegatedEvent:e}),data);this._trigger('progressall',$.Event('progressall',{delegatedEvent:e}),this._progress);}},_initProgressListener:function(options){var that=this,xhr=options.xhr?options.xhr():$.ajaxSettings.xhr();if(xhr.upload){$(xhr.upload).bind('progress',function(e){var oe=e.originalEvent;e.lengthComputable=oe.lengthComputable;e.loaded=oe.loaded;e.total=oe.total;that._onProgress(e,options);});options.xhr=function(){return xhr;};}},_isInstanceOf:function(type,obj){return Object.prototype.toString.call(obj)==='[object '+type+']';},_initXHRData:function(options){var that=this,formData,file=options.files[0],multipart=options.multipart||!$.support.xhrFileUpload,paramName=$.type(options.paramName)==='array'?options.paramName[0]:options.paramName;options.headers=$.extend({},options.headers);if(options.contentRange){options.headers['Content-Range']=options.contentRange;}
if(!multipart||options.blob||!this._isInstanceOf('File',file)){options.headers['Content-Disposition']='attachment; filename="'+
encodeURI(file.name)+'"';}
if(!multipart){options.contentType=file.type||'application/octet-stream';options.data=options.blob||file;}else if($.support.xhrFormDataFileUpload){if(options.postMessage){formData=this._getFormData(options);if(options.blob){formData.push({name:paramName,value:options.blob});}else{$.each(options.files,function(index,file){formData.push({name:($.type(options.paramName)==='array'&&options.paramName[index])||paramName,value:file});});}}else{if(that._isInstanceOf('FormData',options.formData)){formData=options.formData;}else{formData=new FormData();$.each(this._getFormData(options),function(index,field){formData.append(field.name,field.value);});}
if(options.blob){formData.append(paramName,options.blob,file.name);}else{$.each(options.files,function(index,file){if(that._isInstanceOf('File',file)||that._isInstanceOf('Blob',file)){formData.append(($.type(options.paramName)==='array'&&options.paramName[index])||paramName,file,file.uploadName||file.name);}});}}
options.data=formData;}
options.blob=null;},_initIframeSettings:function(options){var targetHost=$('<a></a>').prop('href',options.url).prop('host');options.dataType='iframe '+(options.dataType||'');options.formData=this._getFormData(options);if(options.redirect&&targetHost&&targetHost!==location.host){options.formData.push({name:options.redirectParamName||'redirect',value:options.redirect});}},_initDataSettings:function(options){if(this._isXHRUpload(options)){if(!this._chunkedUpload(options,true)){if(!options.data){this._initXHRData(options);}
this._initProgressListener(options);}
if(options.postMessage){options.dataType='postmessage '+(options.dataType||'');}}else{this._initIframeSettings(options);}},_getParamName:function(options){var fileInput=$(options.fileInput),paramName=options.paramName;if(!paramName){paramName=[];fileInput.each(function(){var input=$(this),name=input.prop('name')||'files[]',i=(input.prop('files')||[1]).length;while(i){paramName.push(name);i-=1;}});if(!paramName.length){paramName=[fileInput.prop('name')||'files[]'];}}else if(!$.isArray(paramName)){paramName=[paramName];}
return paramName;},_initFormSettings:function(options){if(!options.form||!options.form.length){options.form=$(options.fileInput.prop('form'));if(!options.form.length){options.form=$(this.options.fileInput.prop('form'));}}
options.paramName=this._getParamName(options);if(!options.url){options.url=options.form.prop('action')||location.href;}
options.type=(options.type||($.type(options.form.prop('method'))==='string'&&options.form.prop('method'))||'').toUpperCase();if(options.type!=='POST'&&options.type!=='PUT'&&options.type!=='PATCH'){options.type='POST';}
if(!options.formAcceptCharset){options.formAcceptCharset=options.form.attr('accept-charset');}},_getAJAXSettings:function(data){var options=$.extend({},this.options,data);this._initFormSettings(options);this._initDataSettings(options);return options;},_getDeferredState:function(deferred){if(deferred.state){return deferred.state();}
if(deferred.isResolved()){return'resolved';}
if(deferred.isRejected()){return'rejected';}
return'pending';},_enhancePromise:function(promise){promise.success=promise.done;promise.error=promise.fail;promise.complete=promise.always;return promise;},_getXHRPromise:function(resolveOrReject,context,args){var dfd=$.Deferred(),promise=dfd.promise();context=context||this.options.context||promise;if(resolveOrReject===true){dfd.resolveWith(context,args);}else if(resolveOrReject===false){dfd.rejectWith(context,args);}
promise.abort=dfd.promise;return this._enhancePromise(promise);},_addConvenienceMethods:function(e,data){var that=this,getPromise=function(args){return $.Deferred().resolveWith(that,args).promise();};data.process=function(resolveFunc,rejectFunc){if(resolveFunc||rejectFunc){data._processQueue=this._processQueue=(this._processQueue||getPromise([this])).pipe(function(){if(data.errorThrown){return $.Deferred().rejectWith(that,[data]).promise();}
return getPromise(arguments);}).pipe(resolveFunc,rejectFunc);}
return this._processQueue||getPromise([this]);};data.submit=function(){if(this.state()!=='pending'){data.jqXHR=this.jqXHR=(that._trigger('submit',$.Event('submit',{delegatedEvent:e}),this)!==false)&&that._onSend(e,this);}
return this.jqXHR||that._getXHRPromise();};data.abort=function(){if(this.jqXHR){return this.jqXHR.abort();}
this.errorThrown='abort';that._trigger('fail',null,this);return that._getXHRPromise(false);};data.state=function(){if(this.jqXHR){return that._getDeferredState(this.jqXHR);}
if(this._processQueue){return that._getDeferredState(this._processQueue);}};data.processing=function(){return!this.jqXHR&&this._processQueue&&that._getDeferredState(this._processQueue)==='pending';};data.progress=function(){return this._progress;};data.response=function(){return this._response;};},_getUploadedBytes:function(jqXHR){var range=jqXHR.getResponseHeader('Range'),parts=range&&range.split('-'),upperBytesPos=parts&&parts.length>1&&parseInt(parts[1],10);return upperBytesPos&&upperBytesPos+1;},_chunkedUpload:function(options,testOnly){options.uploadedBytes=options.uploadedBytes||0;var that=this,file=options.files[0],fs=file.size,ub=options.uploadedBytes,mcs=options.maxChunkSize||fs,slice=this._blobSlice,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,upload;if(!(this._isXHRUpload(options)&&slice&&(ub||mcs<fs))||options.data){return false;}
if(testOnly){return true;}
if(ub>=fs){file.error=options.i18n('uploadedBytes');return this._getXHRPromise(false,options.context,[null,'error',file.error]);}
upload=function(){var o=$.extend({},options),currentLoaded=o._progress.loaded;o.blob=slice.call(file,ub,ub+mcs,file.type);o.chunkSize=o.blob.size;o.contentRange='bytes '+ub+'-'+
(ub+o.chunkSize-1)+'/'+fs;that._initXHRData(o);that._initProgressListener(o);jqXHR=((that._trigger('chunksend',null,o)!==false&&$.ajax(o))||that._getXHRPromise(false,o.context)).done(function(result,textStatus,jqXHR){ub=that._getUploadedBytes(jqXHR)||(ub+o.chunkSize);if(currentLoaded+o.chunkSize-o._progress.loaded){that._onProgress($.Event('progress',{lengthComputable:true,loaded:ub-o.uploadedBytes,total:ub-o.uploadedBytes}),o);}
options.uploadedBytes=o.uploadedBytes=ub;o.result=result;o.textStatus=textStatus;o.jqXHR=jqXHR;that._trigger('chunkdone',null,o);that._trigger('chunkalways',null,o);if(ub<fs){upload();}else{dfd.resolveWith(o.context,[result,textStatus,jqXHR]);}}).fail(function(jqXHR,textStatus,errorThrown){o.jqXHR=jqXHR;o.textStatus=textStatus;o.errorThrown=errorThrown;that._trigger('chunkfail',null,o);that._trigger('chunkalways',null,o);dfd.rejectWith(o.context,[jqXHR,textStatus,errorThrown]);});};this._enhancePromise(promise);promise.abort=function(){return jqXHR.abort();};upload();return promise;},_beforeSend:function(e,data){if(this._active===0){this._trigger('start');this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0;}
this._initResponseObject(data);this._initProgressObject(data);data._progress.loaded=data.loaded=data.uploadedBytes||0;data._progress.total=data.total=this._getTotal(data.files)||1;data._progress.bitrate=data.bitrate=0;this._active+=1;this._progress.loaded+=data.loaded;this._progress.total+=data.total;},_onDone:function(result,textStatus,jqXHR,options){var total=options._progress.total,response=options._response;if(options._progress.loaded<total){this._onProgress($.Event('progress',{lengthComputable:true,loaded:total,total:total}),options);}
response.result=options.result=result;response.textStatus=options.textStatus=textStatus;response.jqXHR=options.jqXHR=jqXHR;this._trigger('done',null,options);},_onFail:function(jqXHR,textStatus,errorThrown,options){var response=options._response;if(options.recalculateProgress){this._progress.loaded-=options._progress.loaded;this._progress.total-=options._progress.total;}
response.jqXHR=options.jqXHR=jqXHR;response.textStatus=options.textStatus=textStatus;response.errorThrown=options.errorThrown=errorThrown;this._trigger('fail',null,options);},_onAlways:function(jqXHRorResult,textStatus,jqXHRorError,options){this._trigger('always',null,options);},_onSend:function(e,data){if(!data.submit){this._addConvenienceMethods(e,data);}
var that=this,jqXHR,aborted,slot,pipe,options=that._getAJAXSettings(data),send=function(){that._sending+=1;options._bitrateTimer=new that._BitrateTimer();jqXHR=jqXHR||(((aborted||that._trigger('send',$.Event('send',{delegatedEvent:e}),options)===false)&&that._getXHRPromise(false,options.context,aborted))||that._chunkedUpload(options)||$.ajax(options)).done(function(result,textStatus,jqXHR){that._onDone(result,textStatus,jqXHR,options);}).fail(function(jqXHR,textStatus,errorThrown){that._onFail(jqXHR,textStatus,errorThrown,options);}).always(function(jqXHRorResult,textStatus,jqXHRorError){that._onAlways(jqXHRorResult,textStatus,jqXHRorError,options);that._sending-=1;that._active-=1;if(options.limitConcurrentUploads&&options.limitConcurrentUploads>that._sending){var nextSlot=that._slots.shift();while(nextSlot){if(that._getDeferredState(nextSlot)==='pending'){nextSlot.resolve();break;}
nextSlot=that._slots.shift();}}
if(that._active===0){that._trigger('stop');}});return jqXHR;};this._beforeSend(e,options);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){slot=$.Deferred();this._slots.push(slot);pipe=slot.pipe(send);}else{this._sequence=this._sequence.pipe(send,send);pipe=this._sequence;}
pipe.abort=function(){aborted=[undefined,'abort','abort'];if(!jqXHR){if(slot){slot.rejectWith(options.context,aborted);}
return send();}
return jqXHR.abort();};return this._enhancePromise(pipe);}
return send();},_onAdd:function(e,data){var that=this,result=true,options=$.extend({},this.options,data),files=data.files,filesLength=files.length,limit=options.limitMultiFileUploads,limitSize=options.limitMultiFileUploadSize,overhead=options.limitMultiFileUploadSizeOverhead,batchSize=0,paramName=this._getParamName(options),paramNameSet,paramNameSlice,fileSet,i,j=0;if(limitSize&&(!filesLength||files[0].size===undefined)){limitSize=undefined;}
if(!(options.singleFileUploads||limit||limitSize)||!this._isXHRUpload(options)){fileSet=[files];paramNameSet=[paramName];}else if(!(options.singleFileUploads||limitSize)&&limit){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i+=limit){fileSet.push(files.slice(i,i+limit));paramNameSlice=paramName.slice(i,i+limit);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);}}else if(!options.singleFileUploads&&limitSize){fileSet=[];paramNameSet=[];for(i=0;i<filesLength;i=i+1){batchSize+=files[i].size+overhead;if(i+1===filesLength||((batchSize+files[i+1].size+overhead)>limitSize)||(limit&&i+1-j>=limit)){fileSet.push(files.slice(j,i+1));paramNameSlice=paramName.slice(j,i+1);if(!paramNameSlice.length){paramNameSlice=paramName;}
paramNameSet.push(paramNameSlice);j=i+1;batchSize=0;}}}else{paramNameSet=paramName;}
data.originalFiles=files;$.each(fileSet||files,function(index,element){var newData=$.extend({},data);newData.files=fileSet?element:[element];newData.paramName=paramNameSet[index];that._initResponseObject(newData);that._initProgressObject(newData);that._addConvenienceMethods(e,newData);result=that._trigger('add',$.Event('add',{delegatedEvent:e}),newData);return result;});return result;},_replaceFileInput:function(input){var inputClone=input.clone(true);$('<form></form>').append(inputClone)[0].reset();input.after(inputClone).detach();$.cleanData(input.unbind('remove'));this.options.fileInput=this.options.fileInput.map(function(i,el){if(el===input[0]){return inputClone[0];}
return el;});if(input[0]===this.element[0]){this.element=inputClone;}},_handleFileTreeEntry:function(entry,path){var that=this,dfd=$.Deferred(),errorHandler=function(e){if(e&&!e.entry){e.entry=entry;}
dfd.resolve([e]);},dirReader;path=path||'';if(entry.isFile){if(entry._file){entry._file.relativePath=path;dfd.resolve(entry._file);}else{entry.file(function(file){file.relativePath=path;dfd.resolve(file);},errorHandler);}}else if(entry.isDirectory){dirReader=entry.createReader();dirReader.readEntries(function(entries){that._handleFileTreeEntries(entries,path+entry.name+'/').done(function(files){dfd.resolve(files);}).fail(errorHandler);},errorHandler);}else{dfd.resolve([]);}
return dfd.promise();},_handleFileTreeEntries:function(entries,path){var that=this;return $.when.apply($,$.map(entries,function(entry){return that._handleFileTreeEntry(entry,path);})).pipe(function(){return Array.prototype.concat.apply([],arguments);});},_getDroppedFiles:function(dataTransfer){dataTransfer=dataTransfer||{};var items=dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry||items[0].getAsEntry)){return this._handleFileTreeEntries($.map(items,function(item){var entry;if(item.webkitGetAsEntry){entry=item.webkitGetAsEntry();if(entry){entry._file=item.getAsFile();}
return entry;}
return item.getAsEntry();}));}
return $.Deferred().resolve($.makeArray(dataTransfer.files)).promise();},_getSingleFileInputFiles:function(fileInput){fileInput=$(fileInput);var entries=fileInput.prop('webkitEntries')||fileInput.prop('entries'),files,value;if(entries&&entries.length){return this._handleFileTreeEntries(entries);}
files=$.makeArray(fileInput.prop('files'));if(!files.length){value=fileInput.prop('value');if(!value){return $.Deferred().resolve([]).promise();}
files=[{name:value.replace(/^.*\\/,'')}];}else if(files[0].name===undefined&&files[0].fileName){$.each(files,function(index,file){file.name=file.fileName;file.size=file.fileSize;});}
return $.Deferred().resolve(files).promise();},_getFileInputFiles:function(fileInput){if(!(fileInput instanceof $)||fileInput.length===1){return this._getSingleFileInputFiles(fileInput);}
return $.when.apply($,$.map(fileInput,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments);});},_onChange:function(e){var that=this,data={fileInput:$(e.target),form:$(e.target.form)};this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;if(that.options.replaceFileInput){that._replaceFileInput(data.fileInput);}
if(that._trigger('change',$.Event('change',{delegatedEvent:e}),data)!==false){that._onAdd(e,data);}});},_onPaste:function(e){var items=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,data={files:[]};if(items&&items.length){$.each(items,function(index,item){var file=item.getAsFile&&item.getAsFile();if(file){data.files.push(file);}});if(this._trigger('paste',$.Event('paste',{delegatedEvent:e}),data)!==false){this._onAdd(e,data);}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var that=this,dataTransfer=e.dataTransfer,data={};if(dataTransfer&&dataTransfer.files&&dataTransfer.files.length){e.preventDefault();this._getDroppedFiles(dataTransfer).always(function(files){data.files=files;if(that._trigger('drop',$.Event('drop',{delegatedEvent:e}),data)!==false){that._onAdd(e,data);}});}},_onDragOver:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var dataTransfer=e.dataTransfer;if(dataTransfer&&$.inArray('Files',dataTransfer.types)!==-1&&this._trigger('dragover',$.Event('dragover',{delegatedEvent:e}))!==false){e.preventDefault();dataTransfer.dropEffect='copy';}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste});}
if($.support.fileInput){this._on(this.options.fileInput,{change:this._onChange});}},_destroyEventHandlers:function(){this._off(this.options.dropZone,'dragover drop');this._off(this.options.pasteZone,'paste');this._off(this.options.fileInput,'change');},_setOption:function(key,value){var reinit=$.inArray(key,this._specialOptions)!==-1;if(reinit){this._destroyEventHandlers();}
this._super(key,value);if(reinit){this._initSpecialOptions();this._initEventHandlers();}},_initSpecialOptions:function(){var options=this.options;if(options.fileInput===undefined){options.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]');}else if(!(options.fileInput instanceof $)){options.fileInput=$(options.fileInput);}
if(!(options.dropZone instanceof $)){options.dropZone=$(options.dropZone);}
if(!(options.pasteZone instanceof $)){options.pasteZone=$(options.pasteZone);}},_getRegExp:function(str){var parts=str.split('/'),modifiers=parts.pop();parts.shift();return new RegExp(parts.join('/'),modifiers);},_isRegExpOption:function(key,value){return key!=='url'&&$.type(value)==='string'&&/^\/.*\/[igm]{0,3}$/.test(value);},_initDataAttributes:function(){var that=this,options=this.options;$.each($(this.element[0].cloneNode(false)).data(),function(key,value){if(that._isRegExpOption(key,value)){value=that._getRegExp(value);}
options[key]=value;});},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers();},active:function(){return this._active;},progress:function(){return this._progress;},add:function(data){var that=this;if(!data||this.options.disabled){return;}
if(data.fileInput&&!data.files){this._getFileInputFiles(data.fileInput).always(function(files){data.files=files;that._onAdd(null,data);});}else{data.files=$.makeArray(data.files);this._onAdd(null,data);}},send:function(data){if(data&&!this.options.disabled){if(data.fileInput&&!data.files){var that=this,dfd=$.Deferred(),promise=dfd.promise(),jqXHR,aborted;promise.abort=function(){aborted=true;if(jqXHR){return jqXHR.abort();}
dfd.reject(null,'abort','abort');return promise;};this._getFileInputFiles(data.fileInput).always(function(files){if(aborted){return;}
if(!files.length){dfd.reject();return;}
data.files=files;jqXHR=that._onSend(null,data).then(function(result,textStatus,jqXHR){dfd.resolve(result,textStatus,jqXHR);},function(jqXHR,textStatus,errorThrown){dfd.reject(jqXHR,textStatus,errorThrown);});});return this._enhancePromise(promise);}
data.files=$.makeArray(data.files);if(data.files.length){return this._onSend(null,data);}}
return this._getXHRPromise(false,data&&data.context);}});}));
// js/3rd/download/download.js
(function(root,factory){if(typeof define==='function'&&define.amd){define([],factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.download=factory();}}(this,function(){return function download(data,strFileName,strMimeType){var self=window,defaultMime="application/octet-stream",mimeType=strMimeType||defaultMime,payload=data,url=!strFileName&&!strMimeType&&payload,anchor=document.createElement("a"),toString=function(a){return String(a);},myBlob=(self.Blob||self.MozBlob||self.WebKitBlob||toString),fileName=strFileName||"download",blob,reader;myBlob=myBlob.call?myBlob.bind(self):Blob;if(String(this)==="true"){payload=[payload,mimeType];mimeType=payload[0];payload=payload[1];}
if(url&&url.length<2048){fileName=url.split("/").pop().split("?")[0];anchor.href=url;if(anchor.href.indexOf(url)!==-1){var ajax=new XMLHttpRequest();ajax.open("GET",url,true);ajax.responseType='blob';ajax.onload=function(e){download(e.target.response,fileName,defaultMime);};setTimeout(function(){ajax.send();},0);return ajax;}}
if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(payload)){if(payload.length>(1024*1024*1.999)&&myBlob!==toString){payload=dataUrlToBlob(payload);mimeType=payload.type||defaultMime;}else{return navigator.msSaveBlob?navigator.msSaveBlob(dataUrlToBlob(payload),fileName):saver(payload);}}else{if(/([\x80-\xff])/.test(payload)){var i=0,tempUiArr=new Uint8Array(payload.length),mx=tempUiArr.length;for(i;i<mx;++i)tempUiArr[i]=payload.charCodeAt(i);payload=new myBlob([tempUiArr],{type:mimeType});}}
blob=payload instanceof myBlob?payload:new myBlob([payload],{type:mimeType});function dataUrlToBlob(strUrl){var parts=strUrl.split(/[:;,]/),type=parts[1],indexDecoder=strUrl.indexOf("charset")>0?3:2,decoder=parts[indexDecoder]=="base64"?atob:decodeURIComponent,binData=decoder(parts.pop()),mx=binData.length,i=0,uiArr=new Uint8Array(mx);for(i;i<mx;++i)uiArr[i]=binData.charCodeAt(i);return new myBlob([uiArr],{type:type});}
function saver(url,winMode){if('download'in anchor){anchor.href=url;anchor.setAttribute("download",fileName);anchor.className="download-js-link";anchor.innerHTML="downloading...";anchor.style.display="none";anchor.addEventListener('click',function(e){e.stopPropagation();this.removeEventListener('click',arguments.callee);});document.body.appendChild(anchor);setTimeout(function(){anchor.click();document.body.removeChild(anchor);if(winMode===true){setTimeout(function(){self.URL.revokeObjectURL(anchor.href);},250);}},66);return true;}
if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent)){if(/^data:/.test(url))url="data:"+url.replace(/^data:([\w\/\-\+]+)/,defaultMime);if(!window.open(url)){if(confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")){location.href=url;}}
return true;}
var f=document.createElement("iframe");document.body.appendChild(f);if(!winMode&&/^data:/.test(url)){url="data:"+url.replace(/^data:([\w\/\-\+]+)/,defaultMime);}
f.src=url;setTimeout(function(){document.body.removeChild(f);},333);}
if(navigator.msSaveBlob){return navigator.msSaveBlob(blob,fileName);}
if(self.URL){saver(self.URL.createObjectURL(blob),true);}else{if(typeof blob==="string"||blob.constructor===toString){try{return saver("data:"+mimeType+";base64,"+self.btoa(blob));}catch(y){return saver("data:"+mimeType+","+encodeURIComponent(blob));}}
reader=new FileReader();reader.onload=function(e){saver(this.result);};reader.readAsDataURL(blob);}
return true;};}));
// js/3rd/underscore/underscore.js
(function(){var root=typeof self=='object'&&self.self===self&&self||typeof global=='object'&&global.global===global&&global||this||{};var previousUnderscore=root._;var ArrayProto=Array.prototype,ObjProto=Object.prototype;var SymbolProto=typeof Symbol!=='undefined'?Symbol.prototype:null;var push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeCreate=Object.create;var Ctor=function(){};var _=function(obj){if(obj instanceof _)return obj;if(!(this instanceof _))return new _(obj);this._wrapped=obj;};if(typeof exports!='undefined'&&!exports.nodeType){if(typeof module!='undefined'&&!module.nodeType&&module.exports){exports=module.exports=_;}
exports._=_;}else{root._=_;}
_.VERSION='1.9.1';var optimizeCb=function(func,context,argCount){if(context===void 0)return func;switch(argCount==null?3:argCount){case 1:return function(value){return func.call(context,value);};case 3:return function(value,index,collection){return func.call(context,value,index,collection);};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection);};}
return function(){return func.apply(context,arguments);};};var builtinIteratee;var cb=function(value,context,argCount){if(_.iteratee!==builtinIteratee)return _.iteratee(value,context);if(value==null)return _.identity;if(_.isFunction(value))return optimizeCb(value,context,argCount);if(_.isObject(value)&&!_.isArray(value))return _.matcher(value);return _.property(value);};_.iteratee=builtinIteratee=function(value,context){return cb(value,context,Infinity);};var restArguments=function(func,startIndex){startIndex=startIndex==null?func.length-1:+startIndex;return function(){var length=Math.max(arguments.length-startIndex,0),rest=Array(length),index=0;for(;index<length;index++){rest[index]=arguments[index+startIndex];}
switch(startIndex){case 0:return func.call(this,rest);case 1:return func.call(this,arguments[0],rest);case 2:return func.call(this,arguments[0],arguments[1],rest);}
var args=Array(startIndex+1);for(index=0;index<startIndex;index++){args[index]=arguments[index];}
args[startIndex]=rest;return func.apply(this,args);};};var baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;Ctor.prototype=null;return result;};var shallowProperty=function(key){return function(obj){return obj==null?void 0:obj[key];};};var has=function(obj,path){return obj!=null&&hasOwnProperty.call(obj,path);}
var deepGet=function(obj,path){var length=path.length;for(var i=0;i<length;i++){if(obj==null)return void 0;obj=obj[path[i]];}
return length?obj:void 0;};var MAX_ARRAY_INDEX=Math.pow(2,53)-1;var getLength=shallowProperty('length');var isArrayLike=function(collection){var length=getLength(collection);return typeof length=='number'&&length>=0&&length<=MAX_ARRAY_INDEX;};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj)){for(i=0,length=obj.length;i<length;i++){iteratee(obj[i],i,obj);}}else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++){iteratee(obj[keys[i]],keys[i],obj);}}
return obj;};_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length);for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj);}
return results;};var createReduce=function(dir){var reducer=function(obj,iteratee,memo,initial){var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;if(!initial){memo=obj[keys?keys[index]:index];index+=dir;}
for(;index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj);}
return memo;};return function(obj,iteratee,memo,context){var initial=arguments.length>=3;return reducer(obj,optimizeCb(iteratee,context,4),memo,initial);};};_.reduce=_.foldl=_.inject=createReduce(1);_.reduceRight=_.foldr=createReduce(-1);_.find=_.detect=function(obj,predicate,context){var keyFinder=isArrayLike(obj)?_.findIndex:_.findKey;var key=keyFinder(obj,predicate,context);if(key!==void 0&&key!==-1)return obj[key];};_.filter=_.select=function(obj,predicate,context){var results=[];predicate=cb(predicate,context);_.each(obj,function(value,index,list){if(predicate(value,index,list))results.push(value);});return results;};_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context);};_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return false;}
return true;};_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length;for(var index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return true;}
return false;};_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){if(!isArrayLike(obj))obj=_.values(obj);if(typeof fromIndex!='number'||guard)fromIndex=0;return _.indexOf(obj,item,fromIndex)>=0;};_.invoke=restArguments(function(obj,path,args){var contextPath,func;if(_.isFunction(path)){func=path;}else if(_.isArray(path)){contextPath=path.slice(0,-1);path=path[path.length-1];}
return _.map(obj,function(context){var method=func;if(!method){if(contextPath&&contextPath.length){context=deepGet(context,contextPath);}
if(context==null)return void 0;method=context[path];}
return method==null?method:method.apply(context,args);});});_.pluck=function(obj,key){return _.map(obj,_.property(key));};_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs));};_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs));};_.max=function(obj,iteratee,context){var result=-Infinity,lastComputed=-Infinity,value,computed;if(iteratee==null||typeof iteratee=='number'&&typeof obj[0]!='object'&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value!=null&&value>result){result=value;}}}else{iteratee=cb(iteratee,context);_.each(obj,function(v,index,list){computed=iteratee(v,index,list);if(computed>lastComputed||computed===-Infinity&&result===-Infinity){result=v;lastComputed=computed;}});}
return result;};_.min=function(obj,iteratee,context){var result=Infinity,lastComputed=Infinity,value,computed;if(iteratee==null||typeof iteratee=='number'&&typeof obj[0]!='object'&&obj!=null){obj=isArrayLike(obj)?obj:_.values(obj);for(var i=0,length=obj.length;i<length;i++){value=obj[i];if(value!=null&&value<result){result=value;}}}else{iteratee=cb(iteratee,context);_.each(obj,function(v,index,list){computed=iteratee(v,index,list);if(computed<lastComputed||computed===Infinity&&result===Infinity){result=v;lastComputed=computed;}});}
return result;};_.shuffle=function(obj){return _.sample(obj,Infinity);};_.sample=function(obj,n,guard){if(n==null||guard){if(!isArrayLike(obj))obj=_.values(obj);return obj[_.random(obj.length-1)];}
var sample=isArrayLike(obj)?_.clone(obj):_.values(obj);var length=getLength(sample);n=Math.max(Math.min(n,length),0);var last=length-1;for(var index=0;index<n;index++){var rand=_.random(index,last);var temp=sample[index];sample[index]=sample[rand];sample[rand]=temp;}
return sample.slice(0,n);};_.sortBy=function(obj,iteratee,context){var index=0;iteratee=cb(iteratee,context);return _.pluck(_.map(obj,function(value,key,list){return{value:value,index:index++,criteria:iteratee(value,key,list)};}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0)return 1;if(a<b||b===void 0)return-1;}
return left.index-right.index;}),'value');};var group=function(behavior,partition){return function(obj,iteratee,context){var result=partition?[[],[]]:{};iteratee=cb(iteratee,context);_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key);});return result;};};_.groupBy=group(function(result,value,key){if(has(result,key))result[key].push(value);else result[key]=[value];});_.indexBy=group(function(result,value,key){result[key]=value;});_.countBy=group(function(result,value,key){if(has(result,key))result[key]++;else result[key]=1;});var reStrSymbol=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;_.toArray=function(obj){if(!obj)return[];if(_.isArray(obj))return slice.call(obj);if(_.isString(obj)){return obj.match(reStrSymbol);}
if(isArrayLike(obj))return _.map(obj,_.identity);return _.values(obj);};_.size=function(obj){if(obj==null)return 0;return isArrayLike(obj)?obj.length:_.keys(obj).length;};_.partition=group(function(result,value,pass){result[pass?0:1].push(value);},true);_.first=_.head=_.take=function(array,n,guard){if(array==null||array.length<1)return n==null?void 0:[];if(n==null||guard)return array[0];return _.initial(array,array.length-n);};_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(n==null||guard?1:n)));};_.last=function(array,n,guard){if(array==null||array.length<1)return n==null?void 0:[];if(n==null||guard)return array[array.length-1];return _.rest(array,Math.max(0,array.length-n));};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,n==null||guard?1:n);};_.compact=function(array){return _.filter(array,Boolean);};var flatten=function(input,shallow,strict,output){output=output||[];var idx=output.length;for(var i=0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value))){if(shallow){var j=0,len=value.length;while(j<len)output[idx++]=value[j++];}else{flatten(value,shallow,strict,output);idx=output.length;}}else if(!strict){output[idx++]=value;}}
return output;};_.flatten=function(array,shallow){return flatten(array,shallow,false);};_.without=restArguments(function(array,otherArrays){return _.difference(array,otherArrays);});_.uniq=_.unique=function(array,isSorted,iteratee,context){if(!_.isBoolean(isSorted)){context=iteratee;iteratee=isSorted;isSorted=false;}
if(iteratee!=null)iteratee=cb(iteratee,context);var result=[];var seen=[];for(var i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;if(isSorted&&!iteratee){if(!i||seen!==computed)result.push(value);seen=computed;}else if(iteratee){if(!_.contains(seen,computed)){seen.push(computed);result.push(value);}}else if(!_.contains(result,value)){result.push(value);}}
return result;};_.union=restArguments(function(arrays){return _.uniq(flatten(arrays,true,true));});_.intersection=function(array){var result=[];var argsLength=arguments.length;for(var i=0,length=getLength(array);i<length;i++){var item=array[i];if(_.contains(result,item))continue;var j;for(j=1;j<argsLength;j++){if(!_.contains(arguments[j],item))break;}
if(j===argsLength)result.push(item);}
return result;};_.difference=restArguments(function(array,rest){rest=flatten(rest,true,true);return _.filter(array,function(value){return!_.contains(rest,value);});});_.unzip=function(array){var length=array&&_.max(array,getLength).length||0;var result=Array(length);for(var index=0;index<length;index++){result[index]=_.pluck(array,index);}
return result;};_.zip=restArguments(_.unzip);_.object=function(list,values){var result={};for(var i=0,length=getLength(list);i<length;i++){if(values){result[list[i]]=values[i];}else{result[list[i][0]]=list[i][1];}}
return result;};var createPredicateIndexFinder=function(dir){return function(array,predicate,context){predicate=cb(predicate,context);var length=getLength(array);var index=dir>0?0:length-1;for(;index>=0&&index<length;index+=dir){if(predicate(array[index],index,array))return index;}
return-1;};};_.findIndex=createPredicateIndexFinder(1);_.findLastIndex=createPredicateIndexFinder(-1);_.sortedIndex=function(array,obj,iteratee,context){iteratee=cb(iteratee,context,1);var value=iteratee(obj);var low=0,high=getLength(array);while(low<high){var mid=Math.floor((low+high)/2);if(iteratee(array[mid])<value)low=mid+1;else high=mid;}
return low;};var createIndexFinder=function(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if(typeof idx=='number'){if(dir>0){i=idx>=0?idx:Math.max(idx+length,i);}else{length=idx>=0?Math.min(idx+1,length):idx+length+1;}}else if(sortedIndex&&idx&&length){idx=sortedIndex(array,item);return array[idx]===item?idx:-1;}
if(item!==item){idx=predicateFind(slice.call(array,i,length),_.isNaN);return idx>=0?idx+i:-1;}
for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir){if(array[idx]===item)return idx;}
return-1;};};_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex);_.lastIndexOf=createIndexFinder(-1,_.findLastIndex);_.range=function(start,stop,step){if(stop==null){stop=start||0;start=0;}
if(!step){step=stop<start?-1:1;}
var length=Math.max(Math.ceil((stop-start)/step),0);var range=Array(length);for(var idx=0;idx<length;idx++,start+=step){range[idx]=start;}
return range;};_.chunk=function(array,count){if(count==null||count<1)return[];var result=[];var i=0,length=array.length;while(i<length){result.push(slice.call(array,i,i+=count));}
return result;};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype);var result=sourceFunc.apply(self,args);if(_.isObject(result))return result;return self;};_.bind=restArguments(function(func,context,args){if(!_.isFunction(func))throw new TypeError('Bind must be called on a function');var bound=restArguments(function(callArgs){return executeBound(func,bound,context,this,args.concat(callArgs));});return bound;});_.partial=restArguments(function(func,boundArgs){var placeholder=_.partial.placeholder;var bound=function(){var position=0,length=boundArgs.length;var args=Array(length);for(var i=0;i<length;i++){args[i]=boundArgs[i]===placeholder?arguments[position++]:boundArgs[i];}
while(position<arguments.length)args.push(arguments[position++]);return executeBound(func,bound,this,this,args);};return bound;});_.partial.placeholder=_;_.bindAll=restArguments(function(obj,keys){keys=flatten(keys,false,false);var index=keys.length;if(index<1)throw new Error('bindAll must be passed function names');while(index--){var key=keys[index];obj[key]=_.bind(obj[key],obj);}});_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache;var address=''+(hasher?hasher.apply(this,arguments):key);if(!has(cache,address))cache[address]=func.apply(this,arguments);return cache[address];};memoize.cache={};return memoize;};_.delay=restArguments(function(func,wait,args){return setTimeout(function(){return func.apply(null,args);},wait);});_.defer=_.partial(_.delay,_,1);_.throttle=function(func,wait,options){var timeout,context,args,result;var previous=0;if(!options)options={};var later=function(){previous=options.leading===false?0:_.now();timeout=null;result=func.apply(context,args);if(!timeout)context=args=null;};var throttled=function(){var now=_.now();if(!previous&&options.leading===false)previous=now;var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0||remaining>wait){if(timeout){clearTimeout(timeout);timeout=null;}
previous=now;result=func.apply(context,args);if(!timeout)context=args=null;}else if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining);}
return result;};throttled.cancel=function(){clearTimeout(timeout);previous=0;timeout=context=args=null;};return throttled;};_.debounce=function(func,wait,immediate){var timeout,result;var later=function(context,args){timeout=null;if(args)result=func.apply(context,args);};var debounced=restArguments(function(args){if(timeout)clearTimeout(timeout);if(immediate){var callNow=!timeout;timeout=setTimeout(later,wait);if(callNow)result=func.apply(this,args);}else{timeout=_.delay(later,wait,this,args);}
return result;});debounced.cancel=function(){clearTimeout(timeout);timeout=null;};return debounced;};_.wrap=function(func,wrapper){return _.partial(wrapper,func);};_.negate=function(predicate){return function(){return!predicate.apply(this,arguments);};};_.compose=function(){var args=arguments;var start=args.length-1;return function(){var i=start;var result=args[start].apply(this,arguments);while(i--)result=args[i].call(this,result);return result;};};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments);}};};_.before=function(times,func){var memo;return function(){if(--times>0){memo=func.apply(this,arguments);}
if(times<=1)func=null;return memo;};};_.once=_.partial(_.before,2);_.restArguments=restArguments;var hasEnumBug=!{toString:null}.propertyIsEnumerable('toString');var nonEnumerableProps=['valueOf','isPrototypeOf','toString','propertyIsEnumerable','hasOwnProperty','toLocaleString'];var collectNonEnumProps=function(obj,keys){var nonEnumIdx=nonEnumerableProps.length;var constructor=obj.constructor;var proto=_.isFunction(constructor)&&constructor.prototype||ObjProto;var prop='constructor';if(has(obj,prop)&&!_.contains(keys,prop))keys.push(prop);while(nonEnumIdx--){prop=nonEnumerableProps[nonEnumIdx];if(prop in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)){keys.push(prop);}}};_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)if(has(obj,key))keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys;};_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);if(hasEnumBug)collectNonEnumProps(obj,keys);return keys;};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]];}
return values;};_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);var keys=_.keys(obj),length=keys.length,results={};for(var index=0;index<length;index++){var currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj);}
return results;};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]];}
return pairs;};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i];}
return result;};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key]))names.push(key);}
return names.sort();};var createAssigner=function(keysFunc,defaults){return function(obj){var length=arguments.length;if(defaults)obj=Object(obj);if(length<2||obj==null)return obj;for(var index=1;index<length;index++){var source=arguments[index],keys=keysFunc(source),l=keys.length;for(var i=0;i<l;i++){var key=keys[i];if(!defaults||obj[key]===void 0)obj[key]=source[key];}}
return obj;};};_.extend=createAssigner(_.allKeys);_.extendOwn=_.assign=createAssigner(_.keys);_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);var keys=_.keys(obj),key;for(var i=0,length=keys.length;i<length;i++){key=keys[i];if(predicate(obj[key],key,obj))return key;}};var keyInObj=function(value,key,obj){return key in obj;};_.pick=restArguments(function(obj,keys){var result={},iteratee=keys[0];if(obj==null)return result;if(_.isFunction(iteratee)){if(keys.length>1)iteratee=optimizeCb(iteratee,keys[1]);keys=_.allKeys(obj);}else{iteratee=keyInObj;keys=flatten(keys,false,false);obj=Object(obj);}
for(var i=0,length=keys.length;i<length;i++){var key=keys[i];var value=obj[key];if(iteratee(value,key,obj))result[key]=value;}
return result;});_.omit=restArguments(function(obj,keys){var iteratee=keys[0],context;if(_.isFunction(iteratee)){iteratee=_.negate(iteratee);if(keys.length>1)context=keys[1];}else{keys=_.map(flatten(keys,false,false),String);iteratee=function(value,key){return!_.contains(keys,key);};}
return _.pick(obj,iteratee,context);});_.defaults=createAssigner(_.allKeys,true);_.create=function(prototype,props){var result=baseCreate(prototype);if(props)_.extendOwn(result,props);return result;};_.clone=function(obj){if(!_.isObject(obj))return obj;return _.isArray(obj)?obj.slice():_.extend({},obj);};_.tap=function(obj,interceptor){interceptor(obj);return obj;};_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(object==null)return!length;var obj=Object(object);for(var i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return false;}
return true;};var eq,deepEq;eq=function(a,b,aStack,bStack){if(a===b)return a!==0||1/a===1/b;if(a==null||b==null)return false;if(a!==a)return b!==b;var type=typeof a;if(type!=='function'&&type!=='object'&&typeof b!='object')return false;return deepEq(a,b,aStack,bStack);};deepEq=function(a,b,aStack,bStack){if(a instanceof _)a=a._wrapped;if(b instanceof _)b=b._wrapped;var className=toString.call(a);if(className!==toString.call(b))return false;switch(className){case'[object RegExp]':case'[object String]':return''+a===''+b;case'[object Number]':if(+a!==+a)return+b!==+b;return+a===0?1/+a===1/b:+a===+b;case'[object Date]':case'[object Boolean]':return+a===+b;case'[object Symbol]':return SymbolProto.valueOf.call(a)===SymbolProto.valueOf.call(b);}
var areArrays=className==='[object Array]';if(!areArrays){if(typeof a!='object'||typeof b!='object')return false;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&('constructor'in a&&'constructor'in b)){return false;}}
aStack=aStack||[];bStack=bStack||[];var length=aStack.length;while(length--){if(aStack[length]===a)return bStack[length]===b;}
aStack.push(a);bStack.push(b);if(areArrays){length=a.length;if(length!==b.length)return false;while(length--){if(!eq(a[length],b[length],aStack,bStack))return false;}}else{var keys=_.keys(a),key;length=keys.length;if(_.keys(b).length!==length)return false;while(length--){key=keys[length];if(!(has(b,key)&&eq(a[key],b[key],aStack,bStack)))return false;}}
aStack.pop();bStack.pop();return true;};_.isEqual=function(a,b){return eq(a,b);};_.isEmpty=function(obj){if(obj==null)return true;if(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj)))return obj.length===0;return _.keys(obj).length===0;};_.isElement=function(obj){return!!(obj&&obj.nodeType===1);};_.isArray=nativeIsArray||function(obj){return toString.call(obj)==='[object Array]';};_.isObject=function(obj){var type=typeof obj;return type==='function'||type==='object'&&!!obj;};_.each(['Arguments','Function','String','Number','Date','RegExp','Error','Symbol','Map','WeakMap','Set','WeakSet'],function(name){_['is'+name]=function(obj){return toString.call(obj)==='[object '+name+']';};});if(!_.isArguments(arguments)){_.isArguments=function(obj){return has(obj,'callee');};}
var nodelist=root.document&&root.document.childNodes;if(typeof /./!='function'&&typeof Int8Array!='object'&&typeof nodelist!='function'){_.isFunction=function(obj){return typeof obj=='function'||false;};}
_.isFinite=function(obj){return!_.isSymbol(obj)&&isFinite(obj)&&!isNaN(parseFloat(obj));};_.isNaN=function(obj){return _.isNumber(obj)&&isNaN(obj);};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)==='[object Boolean]';};_.isNull=function(obj){return obj===null;};_.isUndefined=function(obj){return obj===void 0;};_.has=function(obj,path){if(!_.isArray(path)){return has(obj,path);}
var length=path.length;for(var i=0;i<length;i++){var key=path[i];if(obj==null||!hasOwnProperty.call(obj,key)){return false;}
obj=obj[key];}
return!!length;};_.noConflict=function(){root._=previousUnderscore;return this;};_.identity=function(value){return value;};_.constant=function(value){return function(){return value;};};_.noop=function(){};_.property=function(path){if(!_.isArray(path)){return shallowProperty(path);}
return function(obj){return deepGet(obj,path);};};_.propertyOf=function(obj){if(obj==null){return function(){};}
return function(path){return!_.isArray(path)?obj[path]:deepGet(obj,path);};};_.matcher=_.matches=function(attrs){attrs=_.extendOwn({},attrs);return function(obj){return _.isMatch(obj,attrs);};};_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum;};_.random=function(min,max){if(max==null){max=min;min=0;}
return min+Math.floor(Math.random()*(max-min+1));};_.now=Date.now||function(){return new Date().getTime();};var escapeMap={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','`':'&#x60;'};var unescapeMap=_.invert(escapeMap);var createEscaper=function(map){var escaper=function(match){return map[match];};var source='(?:'+_.keys(map).join('|')+')';var testRegexp=RegExp(source);var replaceRegexp=RegExp(source,'g');return function(string){string=string==null?'':''+string;return testRegexp.test(string)?string.replace(replaceRegexp,escaper):string;};};_.escape=createEscaper(escapeMap);_.unescape=createEscaper(unescapeMap);_.result=function(obj,path,fallback){if(!_.isArray(path))path=[path];var length=path.length;if(!length){return _.isFunction(fallback)?fallback.call(obj):fallback;}
for(var i=0;i<length;i++){var prop=obj==null?void 0:obj[path[i]];if(prop===void 0){prop=fallback;i=length;}
obj=_.isFunction(prop)?prop.call(obj):prop;}
return obj;};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+'';return prefix?prefix+id:id;};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'",'\\':'\\','\r':'r','\n':'n','\u2028':'u2028','\u2029':'u2029'};var escapeRegExp=/\\|'|\r|\n|\u2028|\u2029/g;var escapeChar=function(match){return'\\'+escapes[match];};_.template=function(text,settings,oldSettings){if(!settings&&oldSettings)settings=oldSettings;settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join('|')+'|$','g');var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escapeRegExp,escapeChar);index=offset+match.length;if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'";}else if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'";}else if(evaluate){source+="';\n"+evaluate+"\n__p+='";}
return match;});source+="';\n";if(!settings.variable)source='with(obj||{}){\n'+source+'}\n';source="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+
source+'return __p;\n';var render;try{render=new Function(settings.variable||'obj','_',source);}catch(e){e.source=source;throw e;}
var template=function(data){return render.call(this,data,_);};var argument=settings.variable||'obj';template.source='function('+argument+'){\n'+source+'}';return template;};_.chain=function(obj){var instance=_(obj);instance._chain=true;return instance;};var chainResult=function(instance,obj){return instance._chain?_(obj).chain():obj;};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return chainResult(this,func.apply(_,args));};});return _;};_.mixin(_);_.each(['pop','push','reverse','shift','sort','splice','unshift'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name==='shift'||name==='splice')&&obj.length===0)delete obj[0];return chainResult(this,obj);};});_.each(['concat','join','slice'],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return chainResult(this,method.apply(this._wrapped,arguments));};});_.prototype.value=function(){return this._wrapped;};_.prototype.valueOf=_.prototype.toJSON=_.prototype.value;_.prototype.toString=function(){return String(this._wrapped);};if(typeof define=='function'&&define.amd){define('underscore',[],function(){return _;});}}());
// js/3rd/underscore/underscore.string.js
(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.s=f()}})(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var trim=require('./trim');var decap=require('./decapitalize');module.exports=function camelize(str,decapitalize){str=trim(str).replace(/[-_\s]+(.)?/g,function(match,c){return c?c.toUpperCase():'';});if(decapitalize===true){return decap(str);}else{return str;}};},{"./decapitalize":10,"./trim":65}],2:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function capitalize(str,lowercaseRest){str=makeString(str);var remainingChars=!lowercaseRest?str.slice(1):str.slice(1).toLowerCase();return str.charAt(0).toUpperCase()+remainingChars;};},{"./helper/makeString":20}],3:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function chars(str){return makeString(str).split('');};},{"./helper/makeString":20}],4:[function(require,module,exports){module.exports=function chop(str,step){if(str==null)return[];str=String(str);step=~~step;return step>0?str.match(new RegExp('.{1,'+step+'}','g')):[str];};},{}],5:[function(require,module,exports){var capitalize=require('./capitalize');var camelize=require('./camelize');var makeString=require('./helper/makeString');module.exports=function classify(str){str=makeString(str);return capitalize(camelize(str.replace(/[\W_]/g,' ')).replace(/\s/g,''));};},{"./camelize":1,"./capitalize":2,"./helper/makeString":20}],6:[function(require,module,exports){var trim=require('./trim');module.exports=function clean(str){return trim(str).replace(/\s\s+/g,' ');};},{"./trim":65}],7:[function(require,module,exports){var makeString=require('./helper/makeString');var from='',to='aaaaaaaaaccceeeeeghiiiijllnnoooooooossssstttuuuuuunyyczzz';from+=from.toUpperCase();to+=to.toUpperCase();to=to.split('');from+='';to.push('ss');module.exports=function cleanDiacritics(str){return makeString(str).replace(/.{1}/g,function(c){var index=from.indexOf(c);return index===-1?c:to[index];});};},{"./helper/makeString":20}],8:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function(str,substr){str=makeString(str);substr=makeString(substr);if(str.length===0||substr.length===0)return 0;return str.split(substr).length-1;};},{"./helper/makeString":20}],9:[function(require,module,exports){var trim=require('./trim');module.exports=function dasherize(str){return trim(str).replace(/([A-Z])/g,'-$1').replace(/[-_\s]+/g,'-').toLowerCase();};},{"./trim":65}],10:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function decapitalize(str){str=makeString(str);return str.charAt(0).toLowerCase()+str.slice(1);};},{"./helper/makeString":20}],11:[function(require,module,exports){var makeString=require('./helper/makeString');function getIndent(str){var matches=str.match(/^[\s\\t]*/gm);var indent=matches[0].length;for(var i=1;i<matches.length;i++){indent=Math.min(matches[i].length,indent);}
return indent;}
module.exports=function dedent(str,pattern){str=makeString(str);var indent=getIndent(str);var reg;if(indent===0)return str;if(typeof pattern==='string'){reg=new RegExp('^'+pattern,'gm');}else{reg=new RegExp('^[ \\t]{'+indent+'}','gm');}
return str.replace(reg,'');};},{"./helper/makeString":20}],12:[function(require,module,exports){var makeString=require('./helper/makeString');var toPositive=require('./helper/toPositive');module.exports=function endsWith(str,ends,position){str=makeString(str);ends=''+ends;if(typeof position=='undefined'){position=str.length-ends.length;}else{position=Math.min(toPositive(position),str.length)-ends.length;}
return position>=0&&str.indexOf(ends,position)===position;};},{"./helper/makeString":20,"./helper/toPositive":22}],13:[function(require,module,exports){var makeString=require('./helper/makeString');var escapeChars=require('./helper/escapeChars');var regexString='[';for(var key in escapeChars){regexString+=key;}
regexString+=']';var regex=new RegExp(regexString,'g');module.exports=function escapeHTML(str){return makeString(str).replace(regex,function(m){return'&'+escapeChars[m]+';';});};},{"./helper/escapeChars":17,"./helper/makeString":20}],14:[function(require,module,exports){module.exports=function(){var result={};for(var prop in this){if(!this.hasOwnProperty(prop)||prop.match(/^(?:include|contains|reverse|join|map|wrap)$/))continue;result[prop]=this[prop];}
return result;};},{}],15:[function(require,module,exports){var makeString=require('./makeString');module.exports=function adjacent(str,direction){str=makeString(str);if(str.length===0){return'';}
return str.slice(0,-1)+String.fromCharCode(str.charCodeAt(str.length-1)+direction);};},{"./makeString":20}],16:[function(require,module,exports){var escapeRegExp=require('./escapeRegExp');module.exports=function defaultToWhiteSpace(characters){if(characters==null)
return'\\s';else if(characters.source)
return characters.source;else
return'['+escapeRegExp(characters)+']';};},{"./escapeRegExp":18}],17:[function(require,module,exports){var escapeChars={'':'cent','':'pound','':'yen','':'euro','':'copy','':'reg','<':'lt','>':'gt','"':'quot','&':'amp','\'':'#39'};module.exports=escapeChars;},{}],18:[function(require,module,exports){var makeString=require('./makeString');module.exports=function escapeRegExp(str){return makeString(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g,'\\$1');};},{"./makeString":20}],19:[function(require,module,exports){var htmlEntities={nbsp:' ',cent:'',pound:'',yen:'',euro:'',copy:'',reg:'',lt:'<',gt:'>',quot:'"',amp:'&',apos:'\''};module.exports=htmlEntities;},{}],20:[function(require,module,exports){module.exports=function makeString(object){if(object==null)return'';return''+object;};},{}],21:[function(require,module,exports){module.exports=function strRepeat(str,qty){if(qty<1)return'';var result='';while(qty>0){if(qty&1)result+=str;qty>>=1,str+=str;}
return result;};},{}],22:[function(require,module,exports){module.exports=function toPositive(number){return number<0?0:(+number||0);};},{}],23:[function(require,module,exports){var capitalize=require('./capitalize');var underscored=require('./underscored');var trim=require('./trim');module.exports=function humanize(str){return capitalize(trim(underscored(str).replace(/_id$/,'').replace(/_/g,' ')));};},{"./capitalize":2,"./trim":65,"./underscored":67}],24:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function include(str,needle){if(needle==='')return true;return makeString(str).indexOf(needle)!==-1;};},{"./helper/makeString":20}],25:[function(require,module,exports){'use strict';function s(value){if(!(this instanceof s))return new s(value);this._wrapped=value;}
s.VERSION='3.3.4';s.isBlank=require('./isBlank');s.stripTags=require('./stripTags');s.capitalize=require('./capitalize');s.decapitalize=require('./decapitalize');s.chop=require('./chop');s.trim=require('./trim');s.clean=require('./clean');s.cleanDiacritics=require('./cleanDiacritics');s.count=require('./count');s.chars=require('./chars');s.swapCase=require('./swapCase');s.escapeHTML=require('./escapeHTML');s.unescapeHTML=require('./unescapeHTML');s.splice=require('./splice');s.insert=require('./insert');s.replaceAll=require('./replaceAll');s.include=require('./include');s.join=require('./join');s.lines=require('./lines');s.dedent=require('./dedent');s.reverse=require('./reverse');s.startsWith=require('./startsWith');s.endsWith=require('./endsWith');s.pred=require('./pred');s.succ=require('./succ');s.titleize=require('./titleize');s.camelize=require('./camelize');s.underscored=require('./underscored');s.dasherize=require('./dasherize');s.classify=require('./classify');s.humanize=require('./humanize');s.ltrim=require('./ltrim');s.rtrim=require('./rtrim');s.truncate=require('./truncate');s.prune=require('./prune');s.words=require('./words');s.pad=require('./pad');s.lpad=require('./lpad');s.rpad=require('./rpad');s.lrpad=require('./lrpad');s.sprintf=require('./sprintf');s.vsprintf=require('./vsprintf');s.toNumber=require('./toNumber');s.numberFormat=require('./numberFormat');s.strRight=require('./strRight');s.strRightBack=require('./strRightBack');s.strLeft=require('./strLeft');s.strLeftBack=require('./strLeftBack');s.toSentence=require('./toSentence');s.toSentenceSerial=require('./toSentenceSerial');s.slugify=require('./slugify');s.surround=require('./surround');s.quote=require('./quote');s.unquote=require('./unquote');s.repeat=require('./repeat');s.naturalCmp=require('./naturalCmp');s.levenshtein=require('./levenshtein');s.toBoolean=require('./toBoolean');s.exports=require('./exports');s.escapeRegExp=require('./helper/escapeRegExp');s.wrap=require('./wrap');s.map=require('./map');s.strip=s.trim;s.lstrip=s.ltrim;s.rstrip=s.rtrim;s.center=s.lrpad;s.rjust=s.lpad;s.ljust=s.rpad;s.contains=s.include;s.q=s.quote;s.toBool=s.toBoolean;s.camelcase=s.camelize;s.mapChars=s.map;s.prototype={value:function value(){return this._wrapped;}};function fn2method(key,fn){if(typeof fn!=='function')return;s.prototype[key]=function(){var args=[this._wrapped].concat(Array.prototype.slice.call(arguments));var res=fn.apply(null,args);return typeof res==='string'?new s(res):res;};}
for(var key in s)fn2method(key,s[key]);fn2method('tap',function tap(string,fn){return fn(string);});function prototype2method(methodName){fn2method(methodName,function(context){var args=Array.prototype.slice.call(arguments,1);return String.prototype[methodName].apply(context,args);});}
var prototypeMethods=['toUpperCase','toLowerCase','split','replace','slice','substring','substr','concat'];for(var method in prototypeMethods)prototype2method(prototypeMethods[method]);module.exports=s;},{"./camelize":1,"./capitalize":2,"./chars":3,"./chop":4,"./classify":5,"./clean":6,"./cleanDiacritics":7,"./count":8,"./dasherize":9,"./decapitalize":10,"./dedent":11,"./endsWith":12,"./escapeHTML":13,"./exports":14,"./helper/escapeRegExp":18,"./humanize":23,"./include":24,"./insert":26,"./isBlank":27,"./join":28,"./levenshtein":29,"./lines":30,"./lpad":31,"./lrpad":32,"./ltrim":33,"./map":34,"./naturalCmp":35,"./numberFormat":38,"./pad":39,"./pred":40,"./prune":41,"./quote":42,"./repeat":43,"./replaceAll":44,"./reverse":45,"./rpad":46,"./rtrim":47,"./slugify":48,"./splice":49,"./sprintf":50,"./startsWith":51,"./strLeft":52,"./strLeftBack":53,"./strRight":54,"./strRightBack":55,"./stripTags":56,"./succ":57,"./surround":58,"./swapCase":59,"./titleize":60,"./toBoolean":61,"./toNumber":62,"./toSentence":63,"./toSentenceSerial":64,"./trim":65,"./truncate":66,"./underscored":67,"./unescapeHTML":68,"./unquote":69,"./vsprintf":70,"./words":71,"./wrap":72}],26:[function(require,module,exports){var splice=require('./splice');module.exports=function insert(str,i,substr){return splice(str,i,0,substr);};},{"./splice":49}],27:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function isBlank(str){return(/^\s*$/).test(makeString(str));};},{"./helper/makeString":20}],28:[function(require,module,exports){var makeString=require('./helper/makeString');var slice=[].slice;module.exports=function join(){var args=slice.call(arguments),separator=args.shift();return args.join(makeString(separator));};},{"./helper/makeString":20}],29:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function levenshtein(str1,str2){'use strict';str1=makeString(str1);str2=makeString(str2);if(str1===str2)return 0;if(!str1||!str2)return Math.max(str1.length,str2.length);var prevRow=new Array(str2.length+1);for(var i=0;i<prevRow.length;++i){prevRow[i]=i;}
for(i=0;i<str1.length;++i){var nextCol=i+1;for(var j=0;j<str2.length;++j){var curCol=nextCol;nextCol=prevRow[j]+((str1.charAt(i)===str2.charAt(j))?0:1);var tmp=curCol+1;if(nextCol>tmp){nextCol=tmp;}
tmp=prevRow[j+1]+1;if(nextCol>tmp){nextCol=tmp;}
prevRow[j]=curCol;}
prevRow[j]=nextCol;}
return nextCol;};},{"./helper/makeString":20}],30:[function(require,module,exports){module.exports=function lines(str){if(str==null)return[];return String(str).split(/\r\n?|\n/);};},{}],31:[function(require,module,exports){var pad=require('./pad');module.exports=function lpad(str,length,padStr){return pad(str,length,padStr);};},{"./pad":39}],32:[function(require,module,exports){var pad=require('./pad');module.exports=function lrpad(str,length,padStr){return pad(str,length,padStr,'both');};},{"./pad":39}],33:[function(require,module,exports){var makeString=require('./helper/makeString');var defaultToWhiteSpace=require('./helper/defaultToWhiteSpace');var nativeTrimLeft=String.prototype.trimLeft;module.exports=function ltrim(str,characters){str=makeString(str);if(!characters&&nativeTrimLeft)return nativeTrimLeft.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp('^'+characters+'+'),'');};},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],34:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function(str,callback){str=makeString(str);if(str.length===0||typeof callback!=='function')return str;return str.replace(/./g,callback);};},{"./helper/makeString":20}],35:[function(require,module,exports){module.exports=function naturalCmp(str1,str2){if(str1==str2)return 0;if(!str1)return-1;if(!str2)return 1;var cmpRegex=/(\.\d+|\d+|\D+)/g,tokens1=String(str1).match(cmpRegex),tokens2=String(str2).match(cmpRegex),count=Math.min(tokens1.length,tokens2.length);for(var i=0;i<count;i++){var a=tokens1[i],b=tokens2[i];if(a!==b){var num1=+a;var num2=+b;if(num1===num1&&num2===num2){return num1>num2?1:-1;}
return a<b?-1:1;}}
if(tokens1.length!=tokens2.length)
return tokens1.length-tokens2.length;return str1<str2?-1:1;};},{}],36:[function(require,module,exports){(function(window){var re={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/}
function sprintf(){var key=arguments[0],cache=sprintf.cache
if(!(cache[key]&&cache.hasOwnProperty(key))){cache[key]=sprintf.parse(key)}
return sprintf.format.call(null,cache[key],arguments)}
sprintf.format=function(parse_tree,argv){var cursor=1,tree_length=parse_tree.length,node_type="",arg,output=[],i,k,match,pad,pad_character,pad_length,is_positive=true,sign=""
for(i=0;i<tree_length;i++){node_type=get_type(parse_tree[i])
if(node_type==="string"){output[output.length]=parse_tree[i]}
else if(node_type==="array"){match=parse_tree[i]
if(match[2]){arg=argv[cursor]
for(k=0;k<match[2].length;k++){if(!arg.hasOwnProperty(match[2][k])){throw new Error(sprintf("[sprintf] property '%s' does not exist",match[2][k]))}
arg=arg[match[2][k]]}}
else if(match[1]){arg=argv[match[1]]}
else{arg=argv[cursor++]}
if(get_type(arg)=="function"){arg=arg()}
if(re.not_string.test(match[8])&&re.not_json.test(match[8])&&(get_type(arg)!="number"&&isNaN(arg))){throw new TypeError(sprintf("[sprintf] expecting number but found %s",get_type(arg)))}
if(re.number.test(match[8])){is_positive=arg>=0}
switch(match[8]){case"b":arg=arg.toString(2)
break
case"c":arg=String.fromCharCode(arg)
break
case"d":case"i":arg=parseInt(arg,10)
break
case"j":arg=JSON.stringify(arg,null,match[6]?parseInt(match[6]):0)
break
case"e":arg=match[7]?arg.toExponential(match[7]):arg.toExponential()
break
case"f":arg=match[7]?parseFloat(arg).toFixed(match[7]):parseFloat(arg)
break
case"g":arg=match[7]?parseFloat(arg).toPrecision(match[7]):parseFloat(arg)
break
case"o":arg=arg.toString(8)
break
case"s":arg=((arg=String(arg))&&match[7]?arg.substring(0,match[7]):arg)
break
case"u":arg=arg>>>0
break
case"x":arg=arg.toString(16)
break
case"X":arg=arg.toString(16).toUpperCase()
break}
if(re.json.test(match[8])){output[output.length]=arg}
else{if(re.number.test(match[8])&&(!is_positive||match[3])){sign=is_positive?"+":"-"
arg=arg.toString().replace(re.sign,"")}
else{sign=""}
pad_character=match[4]?match[4]==="0"?"0":match[4].charAt(1):" "
pad_length=match[6]-(sign+arg).length
pad=match[6]?(pad_length>0?str_repeat(pad_character,pad_length):""):""
output[output.length]=match[5]?sign+arg+pad:(pad_character==="0"?sign+pad+arg:pad+sign+arg)}}}
return output.join("")}
sprintf.cache={}
sprintf.parse=function(fmt){var _fmt=fmt,match=[],parse_tree=[],arg_names=0
while(_fmt){if((match=re.text.exec(_fmt))!==null){parse_tree[parse_tree.length]=match[0]}
else if((match=re.modulo.exec(_fmt))!==null){parse_tree[parse_tree.length]="%"}
else if((match=re.placeholder.exec(_fmt))!==null){if(match[2]){arg_names|=1
var field_list=[],replacement_field=match[2],field_match=[]
if((field_match=re.key.exec(replacement_field))!==null){field_list[field_list.length]=field_match[1]
while((replacement_field=replacement_field.substring(field_match[0].length))!==""){if((field_match=re.key_access.exec(replacement_field))!==null){field_list[field_list.length]=field_match[1]}
else if((field_match=re.index_access.exec(replacement_field))!==null){field_list[field_list.length]=field_match[1]}
else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}
else{throw new SyntaxError("[sprintf] failed to parse named argument key")}
match[2]=field_list}
else{arg_names|=2}
if(arg_names===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}
parse_tree[parse_tree.length]=match}
else{throw new SyntaxError("[sprintf] unexpected placeholder")}
_fmt=_fmt.substring(match[0].length)}
return parse_tree}
var vsprintf=function(fmt,argv,_argv){_argv=(argv||[]).slice(0)
_argv.splice(0,0,fmt)
return sprintf.apply(null,_argv)}
function get_type(variable){return Object.prototype.toString.call(variable).slice(8,-1).toLowerCase()}
function str_repeat(input,multiplier){return Array(multiplier+1).join(input)}
if(typeof exports!=="undefined"){exports.sprintf=sprintf
exports.vsprintf=vsprintf}
else{window.sprintf=sprintf
window.vsprintf=vsprintf
if(typeof define==="function"&&define.amd){define(function(){return{sprintf:sprintf,vsprintf:vsprintf}})}}})(typeof window==="undefined"?this:window);},{}],37:[function(require,module,exports){(function(global){module.exports=deprecate;function deprecate(fn,msg){if(config('noDeprecation')){return fn;}
var warned=false;function deprecated(){if(!warned){if(config('throwDeprecation')){throw new Error(msg);}else if(config('traceDeprecation')){console.trace(msg);}else{console.warn(msg);}
warned=true;}
return fn.apply(this,arguments);}
return deprecated;}
function config(name){try{if(!global.localStorage)return false;}catch(_){return false;}
var val=global.localStorage[name];if(null==val)return false;return String(val).toLowerCase()==='true';}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],38:[function(require,module,exports){module.exports=function numberFormat(number,dec,dsep,tsep){if(isNaN(number)||number==null)return'';number=number.toFixed(~~dec);tsep=typeof tsep=='string'?tsep:',';var parts=number.split('.'),fnums=parts[0],decimals=parts[1]?(dsep||'.')+parts[1]:'';return fnums.replace(/(\d)(?=(?:\d{3})+$)/g,'$1'+tsep)+decimals;};},{}],39:[function(require,module,exports){var makeString=require('./helper/makeString');var strRepeat=require('./helper/strRepeat');module.exports=function pad(str,length,padStr,type){str=makeString(str);length=~~length;var padlen=0;if(!padStr)
padStr=' ';else if(padStr.length>1)
padStr=padStr.charAt(0);switch(type){case'right':padlen=length-str.length;return str+strRepeat(padStr,padlen);case'both':padlen=length-str.length;return strRepeat(padStr,Math.ceil(padlen/2))+str+strRepeat(padStr,Math.floor(padlen/2));default:padlen=length-str.length;return strRepeat(padStr,padlen)+str;}};},{"./helper/makeString":20,"./helper/strRepeat":21}],40:[function(require,module,exports){var adjacent=require('./helper/adjacent');module.exports=function succ(str){return adjacent(str,-1);};},{"./helper/adjacent":15}],41:[function(require,module,exports){var makeString=require('./helper/makeString');var rtrim=require('./rtrim');module.exports=function prune(str,length,pruneStr){str=makeString(str);length=~~length;pruneStr=pruneStr!=null?String(pruneStr):'...';if(str.length<=length)return str;var tmpl=function(c){return c.toUpperCase()!==c.toLowerCase()?'A':' ';},template=str.slice(0,length+1).replace(/.(?=\W*\w*$)/g,tmpl);if(template.slice(template.length-2).match(/\w\w/))
template=template.replace(/\s*\S+$/,'');else
template=rtrim(template.slice(0,template.length-1));return(template+pruneStr).length>str.length?str:str.slice(0,template.length)+pruneStr;};},{"./helper/makeString":20,"./rtrim":47}],42:[function(require,module,exports){var surround=require('./surround');module.exports=function quote(str,quoteChar){return surround(str,quoteChar||'"');};},{"./surround":58}],43:[function(require,module,exports){var makeString=require('./helper/makeString');var strRepeat=require('./helper/strRepeat');module.exports=function repeat(str,qty,separator){str=makeString(str);qty=~~qty;if(separator==null)return strRepeat(str,qty);for(var repeat=[];qty>0;repeat[--qty]=str){}
return repeat.join(separator);};},{"./helper/makeString":20,"./helper/strRepeat":21}],44:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function replaceAll(str,find,replace,ignorecase){var flags=(ignorecase===true)?'gi':'g';var reg=new RegExp(find,flags);return makeString(str).replace(reg,replace);};},{"./helper/makeString":20}],45:[function(require,module,exports){var chars=require('./chars');module.exports=function reverse(str){return chars(str).reverse().join('');};},{"./chars":3}],46:[function(require,module,exports){var pad=require('./pad');module.exports=function rpad(str,length,padStr){return pad(str,length,padStr,'right');};},{"./pad":39}],47:[function(require,module,exports){var makeString=require('./helper/makeString');var defaultToWhiteSpace=require('./helper/defaultToWhiteSpace');var nativeTrimRight=String.prototype.trimRight;module.exports=function rtrim(str,characters){str=makeString(str);if(!characters&&nativeTrimRight)return nativeTrimRight.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp(characters+'+$'),'');};},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],48:[function(require,module,exports){var trim=require('./trim');var dasherize=require('./dasherize');var cleanDiacritics=require('./cleanDiacritics');module.exports=function slugify(str){return trim(dasherize(cleanDiacritics(str).replace(/[^\w\s-]/g,'-').toLowerCase()),'-');};},{"./cleanDiacritics":7,"./dasherize":9,"./trim":65}],49:[function(require,module,exports){var chars=require('./chars');module.exports=function splice(str,i,howmany,substr){var arr=chars(str);arr.splice(~~i,~~howmany,substr);return arr.join('');};},{"./chars":3}],50:[function(require,module,exports){var deprecate=require('util-deprecate');module.exports=deprecate(require('sprintf-js').sprintf,'sprintf() will be removed in the next major release, use the sprintf-js package instead.');},{"sprintf-js":36,"util-deprecate":37}],51:[function(require,module,exports){var makeString=require('./helper/makeString');var toPositive=require('./helper/toPositive');module.exports=function startsWith(str,starts,position){str=makeString(str);starts=''+starts;position=position==null?0:Math.min(toPositive(position),str.length);return str.lastIndexOf(starts,position)===position;};},{"./helper/makeString":20,"./helper/toPositive":22}],52:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function strLeft(str,sep){str=makeString(str);sep=makeString(sep);var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(0,pos):str;};},{"./helper/makeString":20}],53:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function strLeftBack(str,sep){str=makeString(str);sep=makeString(sep);var pos=str.lastIndexOf(sep);return~pos?str.slice(0,pos):str;};},{"./helper/makeString":20}],54:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function strRight(str,sep){str=makeString(str);sep=makeString(sep);var pos=!sep?-1:str.indexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str;};},{"./helper/makeString":20}],55:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function strRightBack(str,sep){str=makeString(str);sep=makeString(sep);var pos=!sep?-1:str.lastIndexOf(sep);return~pos?str.slice(pos+sep.length,str.length):str;};},{"./helper/makeString":20}],56:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function stripTags(str){return makeString(str).replace(/<\/?[^>]+>/g,'');};},{"./helper/makeString":20}],57:[function(require,module,exports){var adjacent=require('./helper/adjacent');module.exports=function succ(str){return adjacent(str,1);};},{"./helper/adjacent":15}],58:[function(require,module,exports){module.exports=function surround(str,wrapper){return[wrapper,str,wrapper].join('');};},{}],59:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function swapCase(str){return makeString(str).replace(/\S/g,function(c){return c===c.toUpperCase()?c.toLowerCase():c.toUpperCase();});};},{"./helper/makeString":20}],60:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function titleize(str){return makeString(str).toLowerCase().replace(/(?:^|\s|-)\S/g,function(c){return c.toUpperCase();});};},{"./helper/makeString":20}],61:[function(require,module,exports){var trim=require('./trim');function boolMatch(s,matchers){var i,matcher,down=s.toLowerCase();matchers=[].concat(matchers);for(i=0;i<matchers.length;i+=1){matcher=matchers[i];if(!matcher)continue;if(matcher.test&&matcher.test(s))return true;if(matcher.toLowerCase()===down)return true;}}
module.exports=function toBoolean(str,trueValues,falseValues){if(typeof str==='number')str=''+str;if(typeof str!=='string')return!!str;str=trim(str);if(boolMatch(str,trueValues||['true','1']))return true;if(boolMatch(str,falseValues||['false','0']))return false;};},{"./trim":65}],62:[function(require,module,exports){module.exports=function toNumber(num,precision){if(num==null)return 0;var factor=Math.pow(10,isFinite(precision)?precision:0);return Math.round(num*factor)/factor;};},{}],63:[function(require,module,exports){var rtrim=require('./rtrim');module.exports=function toSentence(array,separator,lastSeparator,serial){separator=separator||', ';lastSeparator=lastSeparator||' and ';var a=array.slice(),lastMember=a.pop();if(array.length>2&&serial)lastSeparator=rtrim(separator)+lastSeparator;return a.length?a.join(separator)+lastSeparator+lastMember:lastMember;};},{"./rtrim":47}],64:[function(require,module,exports){var toSentence=require('./toSentence');module.exports=function toSentenceSerial(array,sep,lastSep){return toSentence(array,sep,lastSep,true);};},{"./toSentence":63}],65:[function(require,module,exports){var makeString=require('./helper/makeString');var defaultToWhiteSpace=require('./helper/defaultToWhiteSpace');var nativeTrim=String.prototype.trim;module.exports=function trim(str,characters){str=makeString(str);if(!characters&&nativeTrim)return nativeTrim.call(str);characters=defaultToWhiteSpace(characters);return str.replace(new RegExp('^'+characters+'+|'+characters+'+$','g'),'');};},{"./helper/defaultToWhiteSpace":16,"./helper/makeString":20}],66:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function truncate(str,length,truncateStr){str=makeString(str);truncateStr=truncateStr||'...';length=~~length;return str.length>length?str.slice(0,length)+truncateStr:str;};},{"./helper/makeString":20}],67:[function(require,module,exports){var trim=require('./trim');module.exports=function underscored(str){return trim(str).replace(/([a-z\d])([A-Z]+)/g,'$1_$2').replace(/[-\s]+/g,'_').toLowerCase();};},{"./trim":65}],68:[function(require,module,exports){var makeString=require('./helper/makeString');var htmlEntities=require('./helper/htmlEntities');module.exports=function unescapeHTML(str){return makeString(str).replace(/\&([^;]+);/g,function(entity,entityCode){var match;if(entityCode in htmlEntities){return htmlEntities[entityCode];}else if(match=entityCode.match(/^#x([\da-fA-F]+)$/)){return String.fromCharCode(parseInt(match[1],16));}else if(match=entityCode.match(/^#(\d+)$/)){return String.fromCharCode(~~match[1]);}else{return entity;}});};},{"./helper/htmlEntities":19,"./helper/makeString":20}],69:[function(require,module,exports){module.exports=function unquote(str,quoteChar){quoteChar=quoteChar||'"';if(str[0]===quoteChar&&str[str.length-1]===quoteChar)
return str.slice(1,str.length-1);else return str;};},{}],70:[function(require,module,exports){var deprecate=require('util-deprecate');module.exports=deprecate(require('sprintf-js').vsprintf,'vsprintf() will be removed in the next major release, use the sprintf-js package instead.');},{"sprintf-js":36,"util-deprecate":37}],71:[function(require,module,exports){var isBlank=require('./isBlank');var trim=require('./trim');module.exports=function words(str,delimiter){if(isBlank(str))return[];return trim(str,delimiter).split(delimiter||/\s+/);};},{"./isBlank":27,"./trim":65}],72:[function(require,module,exports){var makeString=require('./helper/makeString');module.exports=function wrap(str,options){str=makeString(str);options=options||{};var width=options.width||75;var seperator=options.seperator||'\n';var cut=options.cut||false;var preserveSpaces=options.preserveSpaces||false;var trailingSpaces=options.trailingSpaces||false;var result;if(width<=0){return str;}
else if(!cut){var words=str.split(' ');var current_column=0;result='';while(words.length>0){if(1+words[0].length+current_column>width){if(current_column>0){if(preserveSpaces){result+=' ';current_column++;}
else if(trailingSpaces){while(current_column<width){result+=' ';current_column++;}}
result+=seperator;current_column=0;}}
if(current_column>0){result+=' ';current_column++;}
result+=words[0];current_column+=words[0].length;words.shift();}
if(trailingSpaces){while(current_column<width){result+=' ';current_column++;}}
return result;}
else{var index=0;result='';while(index<str.length){if(index%width==0&&index>0){result+=seperator;}
result+=str.charAt(index);index++;}
if(trailingSpaces){while(index%width>0){result+=' ';index++;}}
return result;}};},{"./helper/makeString":20}]},{},[25])(25)});
// js/3rd/backbone/backbone.js
(function(factory){var root=(typeof self=='object'&&self.self===self&&self)||(typeof global=='object'&&global.global===global&&global);if(typeof define==='function'&&define.amd){define(['underscore','jquery','exports'],function(_,$,exports){root.Backbone=factory(root,exports,_,$);});}else if(typeof exports!=='undefined'){var _=require('underscore'),$;try{$=require('jquery');}catch(e){}
factory(root,exports,_,$);}else{root.Backbone=factory(root,{},root._,(root.jQuery||root.Zepto||root.ender||root.$));}})(function(root,Backbone,_,$){var previousBackbone=root.Backbone;var slice=Array.prototype.slice;Backbone.VERSION='1.3.3';Backbone.$=$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this;};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var addMethod=function(length,method,attribute){switch(length){case 1:return function(){return _[method](this[attribute]);};case 2:return function(value){return _[method](this[attribute],value);};case 3:return function(iteratee,context){return _[method](this[attribute],cb(iteratee,this),context);};case 4:return function(iteratee,defaultVal,context){return _[method](this[attribute],cb(iteratee,this),defaultVal,context);};default:return function(){var args=slice.call(arguments);args.unshift(this[attribute]);return _[method].apply(_,args);};}};var addUnderscoreMethods=function(Class,methods,attribute){_.each(methods,function(length,method){if(_[method])Class.prototype[method]=addMethod(length,method,attribute);});};var cb=function(iteratee,instance){if(_.isFunction(iteratee))return iteratee;if(_.isObject(iteratee)&&!instance._isModel(iteratee))return modelMatcher(iteratee);if(_.isString(iteratee))return function(model){return model.get(iteratee);};return iteratee;};var modelMatcher=function(attrs){var matcher=_.matches(attrs);return function(model){return matcher(model.attributes);};};var Events=Backbone.Events={};var eventSplitter=/\s+/;var eventsApi=function(iteratee,events,name,callback,opts){var i=0,names;if(name&&typeof name==='object'){if(callback!==void 0&&'context'in opts&&opts.context===void 0)opts.context=callback;for(names=_.keys(name);i<names.length;i++){events=eventsApi(iteratee,events,names[i],name[names[i]],opts);}}else if(name&&eventSplitter.test(name)){for(names=name.split(eventSplitter);i<names.length;i++){events=iteratee(events,names[i],callback,opts);}}else{events=iteratee(events,name,callback,opts);}
return events;};Events.on=function(name,callback,context){return internalOn(this,name,callback,context);};var internalOn=function(obj,name,callback,context,listening){obj._events=eventsApi(onApi,obj._events||{},name,callback,{context:context,ctx:obj,listening:listening});if(listening){var listeners=obj._listeners||(obj._listeners={});listeners[listening.id]=listening;}
return obj;};Events.listenTo=function(obj,name,callback){if(!obj)return this;var id=obj._listenId||(obj._listenId=_.uniqueId('l'));var listeningTo=this._listeningTo||(this._listeningTo={});var listening=listeningTo[id];if(!listening){var thisId=this._listenId||(this._listenId=_.uniqueId('l'));listening=listeningTo[id]={obj:obj,objId:id,id:thisId,listeningTo:listeningTo,count:0};}
internalOn(obj,name,callback,this,listening);return this;};var onApi=function(events,name,callback,options){if(callback){var handlers=events[name]||(events[name]=[]);var context=options.context,ctx=options.ctx,listening=options.listening;if(listening)listening.count++;handlers.push({callback:callback,context:context,ctx:context||ctx,listening:listening});}
return events;};Events.off=function(name,callback,context){if(!this._events)return this;this._events=eventsApi(offApi,this._events,name,callback,{context:context,listeners:this._listeners});return this;};Events.stopListening=function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var ids=obj?[obj._listenId]:_.keys(listeningTo);for(var i=0;i<ids.length;i++){var listening=listeningTo[ids[i]];if(!listening)break;listening.obj.off(name,callback,this);}
return this;};var offApi=function(events,name,callback,options){if(!events)return;var i=0,listening;var context=options.context,listeners=options.listeners;if(!name&&!callback&&!context){var ids=_.keys(listeners);for(;i<ids.length;i++){listening=listeners[ids[i]];delete listeners[listening.id];delete listening.listeningTo[listening.objId];}
return;}
var names=name?[name]:_.keys(events);for(;i<names.length;i++){name=names[i];var handlers=events[name];if(!handlers)break;var remaining=[];for(var j=0;j<handlers.length;j++){var handler=handlers[j];if(callback&&callback!==handler.callback&&callback!==handler.callback._callback||context&&context!==handler.context){remaining.push(handler);}else{listening=handler.listening;if(listening&&--listening.count===0){delete listeners[listening.id];delete listening.listeningTo[listening.objId];}}}
if(remaining.length){events[name]=remaining;}else{delete events[name];}}
return events;};Events.once=function(name,callback,context){var events=eventsApi(onceMap,{},name,callback,_.bind(this.off,this));if(typeof name==='string'&&context==null)callback=void 0;return this.on(events,callback,context);};Events.listenToOnce=function(obj,name,callback){var events=eventsApi(onceMap,{},name,callback,_.bind(this.stopListening,this,obj));return this.listenTo(obj,events);};var onceMap=function(map,name,callback,offer){if(callback){var once=map[name]=_.once(function(){offer(name,once);callback.apply(this,arguments);});once._callback=callback;}
return map;};Events.trigger=function(name){if(!this._events)return this;var length=Math.max(0,arguments.length-1);var args=Array(length);for(var i=0;i<length;i++)args[i]=arguments[i+1];eventsApi(triggerApi,this._events,name,void 0,args);return this;};var triggerApi=function(objEvents,name,callback,args){if(objEvents){var events=objEvents[name];var allEvents=objEvents.all;if(events&&allEvents)allEvents=allEvents.slice();if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,[name].concat(args));}
return objEvents;};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args);return;}};Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={});this.cid=_.uniqueId(this.cidPrefix);this.attributes={};if(options.collection)this.collection=options.collection;if(options.parse)attrs=this.parse(attrs,options)||{};var defaults=_.result(this,'defaults');attrs=_.defaults(_.extend({},defaults,attrs),defaults);this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments);};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:'id',cidPrefix:'c',initialize:function(){},toJSON:function(options){return _.clone(this.attributes);},sync:function(){return Backbone.sync.apply(this,arguments);},get:function(attr){return this.attributes[attr];},escape:function(attr){return _.escape(this.get(attr));},has:function(attr){return this.get(attr)!=null;},matches:function(attrs){return!!_.iteratee(attrs,this)(this.attributes);},set:function(key,val,options){if(key==null)return this;var attrs;if(typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options||(options={});if(!this._validate(attrs,options))return false;var unset=options.unset;var silent=options.silent;var changes=[];var changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={};}
var current=this.attributes;var changed=this.changed;var prev=this._previousAttributes;for(var attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){changed[attr]=val;}else{delete changed[attr];}
unset?delete current[attr]:current[attr]=val;}
if(this.idAttribute in attrs)this.id=this.get(this.idAttribute);if(!silent){if(changes.length)this._pending=options;for(var i=0;i<changes.length;i++){this.trigger('change:'+changes[i],this,current[changes[i]],options);}}
if(changing)return this;if(!silent){while(this._pending){options=this._pending;this._pending=false;this.trigger('change',this,options);}}
this._pending=false;this._changing=false;return this;},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}));},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}));},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr);},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var old=this._changing?this._previousAttributes:this.attributes;var changed={};for(var attr in diff){var val=diff[attr];if(_.isEqual(old[attr],val))continue;changed[attr]=val;}
return _.size(changed)?changed:false;},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr];},previousAttributes:function(){return _.clone(this._previousAttributes);},fetch:function(options){options=_.extend({parse:true},options);var model=this;var success=options.success;options.success=function(resp){var serverAttrs=options.parse?model.parse(resp,options):resp;if(!model.set(serverAttrs,options))return false;if(success)success.call(options.context,model,resp,options);model.trigger('sync',model,resp,options);};wrapError(this,options);return this.sync('read',this,options);},save:function(key,val,options){var attrs;if(key==null||typeof key==='object'){attrs=key;options=val;}else{(attrs={})[key]=val;}
options=_.extend({validate:true,parse:true},options);var wait=options.wait;if(attrs&&!wait){if(!this.set(attrs,options))return false;}else if(!this._validate(attrs,options)){return false;}
var model=this;var success=options.success;var attributes=this.attributes;options.success=function(resp){model.attributes=attributes;var serverAttrs=options.parse?model.parse(resp,options):resp;if(wait)serverAttrs=_.extend({},attrs,serverAttrs);if(serverAttrs&&!model.set(serverAttrs,options))return false;if(success)success.call(options.context,model,resp,options);model.trigger('sync',model,resp,options);};wrapError(this,options);if(attrs&&wait)this.attributes=_.extend({},attributes,attrs);var method=this.isNew()?'create':(options.patch?'patch':'update');if(method==='patch'&&!options.attrs)options.attrs=attrs;var xhr=this.sync(method,this,options);this.attributes=attributes;return xhr;},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var wait=options.wait;var destroy=function(){model.stopListening();model.trigger('destroy',model,model.collection,options);};options.success=function(resp){if(wait)destroy();if(success)success.call(options.context,model,resp,options);if(!model.isNew())model.trigger('sync',model,resp,options);};var xhr=false;if(this.isNew()){_.defer(options.success);}else{wrapError(this,options);xhr=this.sync('delete',this,options);}
if(!wait)destroy();return xhr;},url:function(){var base=_.result(this,'urlRoot')||_.result(this.collection,'url')||urlError();if(this.isNew())return base;var id=this.get(this.idAttribute);return base.replace(/[^\/]$/,'$&/')+encodeURIComponent(id);},parse:function(resp,options){return resp;},clone:function(){return new this.constructor(this.attributes);},isNew:function(){return!this.has(this.idAttribute);},isValid:function(options){return this._validate({},_.extend({},options,{validate:true}));},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger('invalid',this,error,_.extend(options,{validationError:error}));return false;}});var modelMethods={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};addUnderscoreMethods(Model,modelMethods,'attributes');var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options));};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,remove:false};var splice=function(array,insert,at){at=Math.min(Math.max(at,0),array.length);var tail=Array(array.length-at);var length=insert.length;var i;for(i=0;i<tail.length;i++)tail[i]=array[i+at];for(i=0;i<length;i++)array[i+at]=insert[i];for(i=0;i<tail.length;i++)array[i+length+at]=tail[i];};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options);});},sync:function(){return Backbone.sync.apply(this,arguments);},add:function(models,options){return this.set(models,_.extend({merge:false},options,addOptions));},remove:function(models,options){options=_.extend({},options);var singular=!_.isArray(models);models=singular?[models]:models.slice();var removed=this._removeModels(models,options);if(!options.silent&&removed.length){options.changes={added:[],merged:[],removed:removed};this.trigger('update',this,options);}
return singular?removed[0]:removed;},set:function(models,options){if(models==null)return;options=_.extend({},setOptions,options);if(options.parse&&!this._isModel(models)){models=this.parse(models,options)||[];}
var singular=!_.isArray(models);models=singular?[models]:models.slice();var at=options.at;if(at!=null)at=+at;if(at>this.length)at=this.length;if(at<0)at+=this.length+1;var set=[];var toAdd=[];var toMerge=[];var toRemove=[];var modelMap={};var add=options.add;var merge=options.merge;var remove=options.remove;var sort=false;var sortable=this.comparator&&at==null&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var model,i;for(i=0;i<models.length;i++){model=models[i];var existing=this.get(model);if(existing){if(merge&&model!==existing){var attrs=this._isModel(model)?model.attributes:model;if(options.parse)attrs=existing.parse(attrs,options);existing.set(attrs,options);toMerge.push(existing);if(sortable&&!sort)sort=existing.hasChanged(sortAttr);}
if(!modelMap[existing.cid]){modelMap[existing.cid]=true;set.push(existing);}
models[i]=existing;}else if(add){model=models[i]=this._prepareModel(model,options);if(model){toAdd.push(model);this._addReference(model,options);modelMap[model.cid]=true;set.push(model);}}}
if(remove){for(i=0;i<this.length;i++){model=this.models[i];if(!modelMap[model.cid])toRemove.push(model);}
if(toRemove.length)this._removeModels(toRemove,options);}
var orderChanged=false;var replace=!sortable&&add&&remove;if(set.length&&replace){orderChanged=this.length!==set.length||_.some(this.models,function(m,index){return m!==set[index];});this.models.length=0;splice(this.models,set,0);this.length=this.models.length;}else if(toAdd.length){if(sortable)sort=true;splice(this.models,toAdd,at==null?this.length:at);this.length=this.models.length;}
if(sort)this.sort({silent:true});if(!options.silent){for(i=0;i<toAdd.length;i++){if(at!=null)options.index=at+i;model=toAdd[i];model.trigger('add',model,this,options);}
if(sort||orderChanged)this.trigger('sort',this,options);if(toAdd.length||toRemove.length||toMerge.length){options.changes={added:toAdd,removed:toRemove,merged:toMerge};this.trigger('update',this,options);}}
return singular?models[0]:models;},reset:function(models,options){options=options?_.clone(options):{};for(var i=0;i<this.models.length;i++){this._removeReference(this.models[i],options);}
options.previousModels=this.models;this._reset();models=this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger('reset',this,options);return models;},push:function(model,options){return this.add(model,_.extend({at:this.length},options));},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options);},unshift:function(model,options){return this.add(model,_.extend({at:0},options));},shift:function(options){var model=this.at(0);return this.remove(model,options);},slice:function(){return slice.apply(this.models,arguments);},get:function(obj){if(obj==null)return void 0;return this._byId[obj]||this._byId[this.modelId(obj.attributes||obj)]||obj.cid&&this._byId[obj.cid];},has:function(obj){return this.get(obj)!=null;},at:function(index){if(index<0)index+=this.length;return this.models[index];},where:function(attrs,first){return this[first?'find':'filter'](attrs);},findWhere:function(attrs){return this.where(attrs,true);},sort:function(options){var comparator=this.comparator;if(!comparator)throw new Error('Cannot sort a set without a comparator');options||(options={});var length=comparator.length;if(_.isFunction(comparator))comparator=_.bind(comparator,this);if(length===1||_.isString(comparator)){this.models=this.sortBy(comparator);}else{this.models.sort(comparator);}
if(!options.silent)this.trigger('sort',this,options);return this;},pluck:function(attr){return this.map(attr+'');},fetch:function(options){options=_.extend({parse:true},options);var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?'reset':'set';collection[method](resp,options);if(success)success.call(options.context,collection,resp,options);collection.trigger('sync',collection,resp,options);};wrapError(this,options);return this.sync('read',this,options);},create:function(model,options){options=options?_.clone(options):{};var wait=options.wait;model=this._prepareModel(model,options);if(!model)return false;if(!wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(m,resp,callbackOpts){if(wait)collection.add(m,callbackOpts);if(success)success.call(callbackOpts.context,m,resp,callbackOpts);};model.save(null,options);return model;},parse:function(resp,options){return resp;},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator});},modelId:function(attrs){return attrs[this.model.prototype.idAttribute||'id'];},_reset:function(){this.length=0;this.models=[];this._byId={};},_prepareModel:function(attrs,options){if(this._isModel(attrs)){if(!attrs.collection)attrs.collection=this;return attrs;}
options=options?_.clone(options):{};options.collection=this;var model=new this.model(attrs,options);if(!model.validationError)return model;this.trigger('invalid',this,model.validationError,options);return false;},_removeModels:function(models,options){var removed=[];for(var i=0;i<models.length;i++){var model=this.get(models[i]);if(!model)continue;var index=this.indexOf(model);this.models.splice(index,1);this.length--;delete this._byId[model.cid];var id=this.modelId(model.attributes);if(id!=null)delete this._byId[id];if(!options.silent){options.index=index;model.trigger('remove',model,this,options);}
removed.push(model);this._removeReference(model,options);}
return removed;},_isModel:function(model){return model instanceof Model;},_addReference:function(model,options){this._byId[model.cid]=model;var id=this.modelId(model.attributes);if(id!=null)this._byId[id]=model;model.on('all',this._onModelEvent,this);},_removeReference:function(model,options){delete this._byId[model.cid];var id=this.modelId(model.attributes);if(id!=null)delete this._byId[id];if(this===model.collection)delete model.collection;model.off('all',this._onModelEvent,this);},_onModelEvent:function(event,model,collection,options){if(model){if((event==='add'||event==='remove')&&collection!==this)return;if(event==='destroy')this.remove(model,options);if(event==='change'){var prevId=this.modelId(model.previousAttributes());var id=this.modelId(model.attributes);if(prevId!==id){if(prevId!=null)delete this._byId[prevId];if(id!=null)this._byId[id]=model;}}}
this.trigger.apply(this,arguments);}});var collectionMethods={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};addUnderscoreMethods(Collection,collectionMethods,'models');var View=Backbone.View=function(options){this.cid=_.uniqueId('view');_.extend(this,_.pick(options,viewOptions));this._ensureElement();this.initialize.apply(this,arguments);};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=['model','collection','el','id','attributes','className','tagName','events'];_.extend(View.prototype,Events,{tagName:'div',$:function(selector){return this.$el.find(selector);},initialize:function(){},render:function(){return this;},remove:function(){this._removeElement();this.stopListening();return this;},_removeElement:function(){this.$el.remove();},setElement:function(element){this.undelegateEvents();this._setElement(element);this.delegateEvents();return this;},_setElement:function(el){this.$el=el instanceof Backbone.$?el:Backbone.$(el);this.el=this.$el[0];},delegateEvents:function(events){events||(events=_.result(this,'events'));if(!events)return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[method];if(!method)continue;var match=key.match(delegateEventSplitter);this.delegate(match[1],match[2],_.bind(method,this));}
return this;},delegate:function(eventName,selector,listener){this.$el.on(eventName+'.delegateEvents'+this.cid,selector,listener);return this;},undelegateEvents:function(){if(this.$el)this.$el.off('.delegateEvents'+this.cid);return this;},undelegate:function(eventName,selector,listener){this.$el.off(eventName+'.delegateEvents'+this.cid,selector,listener);return this;},_createElement:function(tagName){return document.createElement(tagName);},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,'attributes'));if(this.id)attrs.id=_.result(this,'id');if(this.className)attrs['class']=_.result(this,'className');this.setElement(this._createElement(_.result(this,'tagName')));this._setAttributes(attrs);}else{this.setElement(_.result(this,'el'));}},_setAttributes:function(attributes){this.$el.attr(attributes);}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:'json'};if(!options.url){params.url=_.result(model,'url')||urlError();}
if(options.data==null&&model&&(method==='create'||method==='update'||method==='patch')){params.contentType='application/json';params.data=JSON.stringify(options.attrs||model.toJSON(options));}
if(options.emulateJSON){params.contentType='application/x-www-form-urlencoded';params.data=params.data?{model:params.data}:{};}
if(options.emulateHTTP&&(type==='PUT'||type==='DELETE'||type==='PATCH')){params.type='POST';if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader('X-HTTP-Method-Override',type);if(beforeSend)return beforeSend.apply(this,arguments);};}
if(params.type!=='GET'&&!options.emulateJSON){params.processData=false;}
var error=options.error;options.error=function(xhr,textStatus,errorThrown){options.textStatus=textStatus;options.errorThrown=errorThrown;if(error)error.call(options.context,xhr,textStatus,errorThrown);};var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger('request',model,xhr,options);return xhr;};var methodMap={'create':'POST','update':'PUT','patch':'PATCH','delete':'DELETE','read':'GET'};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments);};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments);};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name='';}
if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);if(router.execute(callback,args,name)!==false){router.trigger.apply(router,['route:'+name].concat(args));router.trigger('route',name,args);Backbone.history.trigger('route',router,name,args);}});return this;},execute:function(callback,args,name){if(callback)callback.apply(this,args);},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this;},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,'routes');var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route]);}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,'\\$&').replace(optionalParam,'(?:$1)?').replace(namedParam,function(match,optional){return optional?match:'([^/?]+)';}).replace(splatParam,'([^?]*?)');return new RegExp('^'+route+'(?:\\?([\\s\\S]*))?$');},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){if(i===params.length-1)return param||null;return param?decodeURIComponent(param):null;});}});var History=Backbone.History=function(){this.handlers=[];this.checkUrl=_.bind(this.checkUrl,this);if(typeof window!=='undefined'){this.location=window.location;this.history=window.history;}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var pathStripper=/#.*$/;History.started=false;_.extend(History.prototype,Events,{interval:50,atRoot:function(){var path=this.location.pathname.replace(/[^\/]$/,'$&/');return path===this.root&&!this.getSearch();},matchRoot:function(){var path=this.decodeFragment(this.location.pathname);var rootPath=path.slice(0,this.root.length-1)+'/';return rootPath===this.root;},decodeFragment:function(fragment){return decodeURI(fragment.replace(/%25/g,'%2525'));},getSearch:function(){var match=this.location.href.replace(/#.*/,'').match(/\?.+/);return match?match[0]:'';},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:'';},getPath:function(){var path=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return path.charAt(0)==='/'?path.slice(1):path;},getFragment:function(fragment){if(fragment==null){if(this._usePushState||!this._wantsHashChange){fragment=this.getPath();}else{fragment=this.getHash();}}
return fragment.replace(routeStripper,'');},start:function(options){if(History.started)throw new Error('Backbone.history has already been started');History.started=true;this.options=_.extend({root:'/'},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._hasHashChange='onhashchange'in window&&(document.documentMode===void 0||document.documentMode>7);this._useHashChange=this._wantsHashChange&&this._hasHashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.history&&this.history.pushState);this._usePushState=this._wantsPushState&&this._hasPushState;this.fragment=this.getFragment();this.root=('/'+this.root+'/').replace(rootStripper,'/');if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var rootPath=this.root.slice(0,-1)||'/';this.location.replace(rootPath+'#'+this.getPath());return true;}else if(this._hasPushState&&this.atRoot()){this.navigate(this.getHash(),{replace:true});}}
if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement('iframe');this.iframe.src='javascript:0';this.iframe.style.display='none';this.iframe.tabIndex=-1;var body=document.body;var iWindow=body.insertBefore(this.iframe,body.firstChild).contentWindow;iWindow.document.open();iWindow.document.close();iWindow.location.hash='#'+this.fragment;}
var addEventListener=window.addEventListener||function(eventName,listener){return attachEvent('on'+eventName,listener);};if(this._usePushState){addEventListener('popstate',this.checkUrl,false);}else if(this._useHashChange&&!this.iframe){addEventListener('hashchange',this.checkUrl,false);}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval);}
if(!this.options.silent)return this.loadUrl();},stop:function(){var removeEventListener=window.removeEventListener||function(eventName,listener){return detachEvent('on'+eventName,listener);};if(this._usePushState){removeEventListener('popstate',this.checkUrl,false);}else if(this._useHashChange&&!this.iframe){removeEventListener('hashchange',this.checkUrl,false);}
if(this.iframe){document.body.removeChild(this.iframe);this.iframe=null;}
if(this._checkUrlInterval)clearInterval(this._checkUrlInterval);History.started=false;},route:function(route,callback){this.handlers.unshift({route:route,callback:callback});},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getHash(this.iframe.contentWindow);}
if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl();},loadUrl:function(fragment){if(!this.matchRoot())return false;fragment=this.fragment=this.getFragment(fragment);return _.some(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true;}});},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:!!options};fragment=this.getFragment(fragment||'');var rootPath=this.root;if(fragment===''||fragment.charAt(0)==='?'){rootPath=rootPath.slice(0,-1)||'/';}
var url=rootPath+fragment;fragment=this.decodeFragment(fragment.replace(pathStripper,''));if(this.fragment===fragment)return;this.fragment=fragment;if(this._usePushState){this.history[options.replace?'replaceState':'pushState']({},document.title,url);}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getHash(this.iframe.contentWindow)){var iWindow=this.iframe.contentWindow;if(!options.replace){iWindow.document.open();iWindow.document.close();}
this._updateHash(iWindow.location,fragment,options.replace);}}else{return this.location.assign(url);}
if(options.trigger)return this.loadUrl(fragment);},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,'');location.replace(href+'#'+fragment);}else{location.hash='#'+fragment;}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,'constructor')){child=protoProps.constructor;}else{child=function(){return parent.apply(this,arguments);};}
_.extend(child,parent,staticProps);child.prototype=_.create(parent.prototype,protoProps);child.prototype.constructor=child;child.__super__=parent.prototype;return child;};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified');};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error.call(options.context,model,resp,options);model.trigger('error',model,resp,options);};};return Backbone;});
// js/3rd/backbone/backgrid.js
/*
  backgrid 0.3.8
  http://github.com/cloudflare/backgrid

  Copyright (c) 2017 Cloudflare, Inc. and contributors <jwong@cloudflare.com>
  Licensed under the MIT license.
*/
(function(root,factory){if(typeof define==="function"&&define.amd){define(["underscore","backbone"],function(_,Backbone){return(root.Backgrid=factory(_,Backbone));});}else if(typeof exports==="object"){module.exports=factory(require("underscore"),require("backbone"));}else{root.Backgrid=factory(root._,root.Backbone);}}(this,function(_,Backbone){"use strict";var ws="\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028"+"\u2029\uFEFF";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=new RegExp("^"+ws+ws+"*"),trimEndRegexp=new RegExp(ws+ws+"*$");String.prototype.trim=function trim(){if(this===undefined||this===null){throw new TypeError("can't convert "+this+" to object");}
return String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"");};}
function lpad(str,length,padstr){var paddingLen=length-(str+'').length;paddingLen=paddingLen<0?0:paddingLen;var padding='';for(var i=0;i<paddingLen;i++){padding=padding+padstr;}
return padding+str;}
var $=Backbone.$;var Backgrid={Extension:{},resolveNameToClass:function(name,suffix){if(_.isString(name)){var key=_.map(name.split('-'),function(e){return e.slice(0,1).toUpperCase()+e.slice(1);}).join('')+suffix;var klass=Backgrid[key]||Backgrid.Extension[key];if(_.isUndefined(klass)){throw new ReferenceError("Class '"+key+"' not found");}
return klass;}
return name;},callByNeed:function(){var value=arguments[0];if(!_.isFunction(value))return value;var context=arguments[1];var args=[].slice.call(arguments,2);return value.apply(context,!!(args+'')?args:[]);}};_.extend(Backgrid,Backbone.Events);var Command=Backgrid.Command=function(evt){_.extend(this,{altKey:!!evt.altKey,"char":evt["char"],charCode:evt.charCode,ctrlKey:!!evt.ctrlKey,key:evt.key,keyCode:evt.keyCode,locale:evt.locale,location:evt.location,metaKey:!!evt.metaKey,repeat:!!evt.repeat,shiftKey:!!evt.shiftKey,which:evt.which});};_.extend(Command.prototype,{moveUp:function(){return this.keyCode==38;},moveDown:function(){return this.keyCode===40;},moveLeft:function(){return this.shiftKey&&this.keyCode===9;},moveRight:function(){return!this.shiftKey&&this.keyCode===9;},save:function(){return this.keyCode===13;},cancel:function(){return this.keyCode===27;},passThru:function(){return!(this.moveUp()||this.moveDown()||this.moveLeft()||this.moveRight()||this.save()||this.cancel());}});var CellFormatter=Backgrid.CellFormatter=function(){};_.extend(CellFormatter.prototype,{fromRaw:function(rawData,model){return rawData;},toRaw:function(formattedData,model){return formattedData;}});var NumberFormatter=Backgrid.NumberFormatter=function(options){_.extend(this,this.defaults,options||{});if(this.decimals<0||this.decimals>20){throw new RangeError("decimals must be between 0 and 20");}};NumberFormatter.prototype=new CellFormatter();_.extend(NumberFormatter.prototype,{defaults:{decimals:2,decimalSeparator:'.',orderSeparator:','},HUMANIZED_NUM_RE:/(\d)(?=(?:\d{3})+$)/g,fromRaw:function(number,model){if(_.isNull(number)||_.isUndefined(number))return'';number=parseFloat(number).toFixed(~~this.decimals);var parts=number.split('.');var integerPart=parts[0];var decimalPart=parts[1]?(this.decimalSeparator||'.')+parts[1]:'';return integerPart.replace(this.HUMANIZED_NUM_RE,'$1'+this.orderSeparator)+decimalPart;},toRaw:function(formattedData,model){formattedData=formattedData.trim();if(formattedData==='')return null;var rawData='';var thousands=formattedData.split(this.orderSeparator);for(var i=0;i<thousands.length;i++){rawData+=thousands[i];}
var decimalParts=rawData.split(this.decimalSeparator);rawData='';for(var i=0;i<decimalParts.length;i++){rawData=rawData+decimalParts[i]+'.';}
if(rawData[rawData.length-1]==='.'){rawData=rawData.slice(0,rawData.length-1);}
var result=(rawData*1).toFixed(~~this.decimals)*1;if(_.isNumber(result)&&!_.isNaN(result))return result;}});var PercentFormatter=Backgrid.PercentFormatter=function(){Backgrid.NumberFormatter.apply(this,arguments);};PercentFormatter.prototype=new Backgrid.NumberFormatter(),_.extend(PercentFormatter.prototype,{defaults:_.extend({},NumberFormatter.prototype.defaults,{multiplier:1,symbol:"%"}),fromRaw:function(number,model){var args=[].slice.call(arguments,1);args.unshift(number*this.multiplier);return(NumberFormatter.prototype.fromRaw.apply(this,args)||"0")+this.symbol;},toRaw:function(formattedValue,model){var tokens=formattedValue.split(this.symbol);if(tokens&&tokens[0]&&tokens[1]===""||tokens[1]==null){var rawValue=NumberFormatter.prototype.toRaw.call(this,tokens[0]);if(_.isUndefined(rawValue))return rawValue;return rawValue/this.multiplier;}}});var DatetimeFormatter=Backgrid.DatetimeFormatter=function(options){_.extend(this,this.defaults,options||{});if(!this.includeDate&&!this.includeTime){throw new Error("Either includeDate or includeTime must be true");}};DatetimeFormatter.prototype=new CellFormatter();_.extend(DatetimeFormatter.prototype,{defaults:{includeDate:true,includeTime:true,includeMilli:false},DATE_RE:/^([+\-]?\d{4})-(\d{2})-(\d{2})$/,TIME_RE:/^(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?$/,ISO_SPLITTER_RE:/T|Z| +/,_convert:function(data,validate){if((data+'').trim()==='')return null;var date,time=null;if(_.isNumber(data)){var jsDate=new Date(data);date=lpad(jsDate.getUTCFullYear(),4,0)+'-'+lpad(jsDate.getUTCMonth()+1,2,0)+'-'+lpad(jsDate.getUTCDate(),2,0);time=lpad(jsDate.getUTCHours(),2,0)+':'+lpad(jsDate.getUTCMinutes(),2,0)+':'+lpad(jsDate.getUTCSeconds(),2,0);}
else{data=data.trim();var parts=data.split(this.ISO_SPLITTER_RE)||[];date=this.DATE_RE.test(parts[0])?parts[0]:'';time=date&&parts[1]?parts[1]:this.TIME_RE.test(parts[0])?parts[0]:'';}
var YYYYMMDD=this.DATE_RE.exec(date)||[];var HHmmssSSS=this.TIME_RE.exec(time)||[];if(validate){if(this.includeDate&&_.isUndefined(YYYYMMDD[0]))return;if(this.includeTime&&_.isUndefined(HHmmssSSS[0]))return;if(!this.includeDate&&date)return;if(!this.includeTime&&time)return;}
var jsDate=new Date(Date.UTC(YYYYMMDD[1]*1||0,YYYYMMDD[2]*1-1||0,YYYYMMDD[3]*1||0,HHmmssSSS[1]*1||null,HHmmssSSS[2]*1||null,HHmmssSSS[3]*1||null,HHmmssSSS[5]*1||null));var result='';if(this.includeDate){result=lpad(jsDate.getUTCFullYear(),4,0)+'-'+lpad(jsDate.getUTCMonth()+1,2,0)+'-'+lpad(jsDate.getUTCDate(),2,0);}
if(this.includeTime){result=result+(this.includeDate?'T':'')+lpad(jsDate.getUTCHours(),2,0)+':'+lpad(jsDate.getUTCMinutes(),2,0)+':'+lpad(jsDate.getUTCSeconds(),2,0);if(this.includeMilli){result=result+'.'+lpad(jsDate.getUTCMilliseconds(),3,0);}}
if(this.includeDate&&this.includeTime){result+="Z";}
return result;},fromRaw:function(rawData,model){if(_.isNull(rawData)||_.isUndefined(rawData))return'';return this._convert(rawData);},toRaw:function(formattedData,model){return this._convert(formattedData,true);}});var StringFormatter=Backgrid.StringFormatter=function(){};StringFormatter.prototype=new CellFormatter();_.extend(StringFormatter.prototype,{fromRaw:function(rawValue,model){if(_.isUndefined(rawValue)||_.isNull(rawValue))return'';return rawValue+'';}});var EmailFormatter=Backgrid.EmailFormatter=function(){};EmailFormatter.prototype=new CellFormatter();_.extend(EmailFormatter.prototype,{toRaw:function(formattedData,model){var parts=formattedData.trim().split("@");if(parts.length===2&&_.all(parts)){return formattedData;}}});var SelectFormatter=Backgrid.SelectFormatter=function(){};SelectFormatter.prototype=new CellFormatter();_.extend(SelectFormatter.prototype,{fromRaw:function(rawValue,model){return _.isArray(rawValue)?rawValue:rawValue!=null?[rawValue]:[];}});var CellEditor=Backgrid.CellEditor=Backbone.View.extend({initialize:function(options){this.formatter=options.formatter;this.column=options.column;if(!(this.column instanceof Column)){this.column=new Column(this.column);}
this.listenTo(this.model,"backgrid:editing",this.postRender);},postRender:function(model,column){if(column==null||column.get("name")==this.column.get("name")){this.$el.focus();}
return this;}});var InputCellEditor=Backgrid.InputCellEditor=CellEditor.extend({tagName:"input",attributes:{type:"text"},events:{"blur":"saveOrCancel","keydown":"saveOrCancel"},initialize:function(options){InputCellEditor.__super__.initialize.apply(this,arguments);if(options.placeholder){this.$el.attr("placeholder",options.placeholder);}},render:function(){var model=this.model;this.$el.val(this.formatter.fromRaw(model.get(this.column.get("name")),model));return this;},saveOrCancel:function(e){var formatter=this.formatter;var model=this.model;var column=this.column;var command=new Command(e);var blurred=e.type==="blur";if(command.moveUp()||command.moveDown()||command.moveLeft()||command.moveRight()||command.save()||blurred){e.preventDefault();e.stopPropagation();var val=this.$el.val();var newValue=formatter.toRaw(val,model);if(_.isUndefined(newValue)){model.trigger("backgrid:error",model,column,val);}
else{model.set(column.get("name"),newValue);model.trigger("backgrid:edited",model,column,command);}}
else if(command.cancel()){e.stopPropagation();model.trigger("backgrid:edited",model,column,command);}},postRender:function(model,column){if(column==null||column.get("name")==this.column.get("name")){if(this.$el.css("text-align")==="right"){var val=this.$el.val();this.$el.focus().val(null).val(val);}
else this.$el.focus();}
return this;}});var Cell=Backgrid.Cell=Backbone.View.extend({tagName:"td",formatter:CellFormatter,editor:InputCellEditor,events:{"click":"enterEditMode"},initialize:function(options){this.column=options.column;if(!(this.column instanceof Column)){this.column=new Column(this.column);}
var column=this.column,model=this.model,$el=this.$el;var formatter=Backgrid.resolveNameToClass(column.get("formatter")||this.formatter,"Formatter");if(!_.isFunction(formatter.fromRaw)&&!_.isFunction(formatter.toRaw)){formatter=new formatter();}
this.formatter=formatter;this.editor=Backgrid.resolveNameToClass(this.editor,"CellEditor");this.listenTo(model,"change:"+column.get("name"),function(){if(!$el.hasClass("editor"))this.render();});this.listenTo(model,"backgrid:error",this.renderError);this.listenTo(column,"change:editable change:sortable change:renderable",function(column){var changed=column.changedAttributes();for(var key in changed){if(changed.hasOwnProperty(key)){$el.toggleClass(key,changed[key]);}}});this.updateStateClassesMaybe();},updateStateClassesMaybe:function(){var model=this.model;var column=this.column;var $el=this.$el;$el.toggleClass("editable",Backgrid.callByNeed(column.editable(),column,model));$el.toggleClass("sortable",Backgrid.callByNeed(column.sortable(),column,model));$el.toggleClass("renderable",Backgrid.callByNeed(column.renderable(),column,model));},render:function(){var $el=this.$el;$el.empty();var model=this.model;var columnName=this.column.get("name");$el.text(this.formatter.fromRaw(model.get(columnName),model));$el.addClass(columnName);this.updateStateClassesMaybe();this.delegateEvents();return this;},enterEditMode:function(){var model=this.model;var column=this.column;var editable=Backgrid.callByNeed(column.editable(),column,model);if(editable){this.currentEditor=new this.editor({column:this.column,model:this.model,formatter:this.formatter});model.trigger("backgrid:edit",model,column,this,this.currentEditor);this.undelegateEvents();this.$el.empty();this.$el.append(this.currentEditor.$el);this.currentEditor.render();this.$el.addClass("editor");model.trigger("backgrid:editing",model,column,this,this.currentEditor);}},renderError:function(model,column){if(column==null||column.get("name")==this.column.get("name")){this.$el.addClass("error");}},exitEditMode:function(){this.$el.removeClass("error");this.currentEditor.remove();this.stopListening(this.currentEditor);delete this.currentEditor;this.$el.removeClass("editor");this.render();},remove:function(){if(this.currentEditor){this.currentEditor.remove.apply(this.currentEditor,arguments);delete this.currentEditor;}
return Cell.__super__.remove.apply(this,arguments);}});var StringCell=Backgrid.StringCell=Cell.extend({className:"string-cell",formatter:StringFormatter});var UriCell=Backgrid.UriCell=Cell.extend({className:"uri-cell",title:null,target:"_blank",initialize:function(options){UriCell.__super__.initialize.apply(this,arguments);this.title=options.title||this.title;this.target=options.target||this.target;},render:function(){this.$el.empty();var rawValue=this.model.get(this.column.get("name"));var formattedValue=this.formatter.fromRaw(rawValue,this.model);this.$el.append($("<a>",{tabIndex:-1,href:rawValue,title:this.title||formattedValue,target:this.target}).text(formattedValue));this.delegateEvents();return this;}});var EmailCell=Backgrid.EmailCell=StringCell.extend({className:"email-cell",formatter:EmailFormatter,render:function(){this.$el.empty();var model=this.model;var formattedValue=this.formatter.fromRaw(model.get(this.column.get("name")),model);this.$el.append($("<a>",{tabIndex:-1,href:"mailto:"+formattedValue,title:formattedValue}).text(formattedValue));this.delegateEvents();return this;}});var NumberCell=Backgrid.NumberCell=Cell.extend({className:"number-cell",decimals:NumberFormatter.prototype.defaults.decimals,decimalSeparator:NumberFormatter.prototype.defaults.decimalSeparator,orderSeparator:NumberFormatter.prototype.defaults.orderSeparator,formatter:NumberFormatter,initialize:function(options){NumberCell.__super__.initialize.apply(this,arguments);var formatter=this.formatter;formatter.decimals=this.decimals;formatter.decimalSeparator=this.decimalSeparator;formatter.orderSeparator=this.orderSeparator;}});var IntegerCell=Backgrid.IntegerCell=NumberCell.extend({className:"integer-cell",decimals:0});var PercentCell=Backgrid.PercentCell=NumberCell.extend({className:"percent-cell",multiplier:PercentFormatter.prototype.defaults.multiplier,symbol:PercentFormatter.prototype.defaults.symbol,formatter:PercentFormatter,initialize:function(){PercentCell.__super__.initialize.apply(this,arguments);var formatter=this.formatter;formatter.multiplier=this.multiplier;formatter.symbol=this.symbol;}});var DatetimeCell=Backgrid.DatetimeCell=Cell.extend({className:"datetime-cell",includeDate:DatetimeFormatter.prototype.defaults.includeDate,includeTime:DatetimeFormatter.prototype.defaults.includeTime,includeMilli:DatetimeFormatter.prototype.defaults.includeMilli,formatter:DatetimeFormatter,initialize:function(options){DatetimeCell.__super__.initialize.apply(this,arguments);var formatter=this.formatter;formatter.includeDate=this.includeDate;formatter.includeTime=this.includeTime;formatter.includeMilli=this.includeMilli;var placeholder=this.includeDate?"YYYY-MM-DD":"";placeholder+=(this.includeDate&&this.includeTime)?"T":"";placeholder+=this.includeTime?"HH:mm:ss":"";placeholder+=(this.includeTime&&this.includeMilli)?".SSS":"";this.editor=this.editor.extend({attributes:_.extend({},this.editor.prototype.attributes,this.editor.attributes,{placeholder:placeholder})});}});var DateCell=Backgrid.DateCell=DatetimeCell.extend({className:"date-cell",includeTime:false});var TimeCell=Backgrid.TimeCell=DatetimeCell.extend({className:"time-cell",includeDate:false});var BooleanCellEditor=Backgrid.BooleanCellEditor=CellEditor.extend({tagName:"input",attributes:{tabIndex:-1,type:"checkbox"},events:{"mousedown":function(){this.mouseDown=true;},"blur":"enterOrExitEditMode","mouseup":function(){this.mouseDown=false;},"change":"saveOrCancel","keydown":"saveOrCancel"},render:function(){var model=this.model;var val=this.formatter.fromRaw(model.get(this.column.get("name")),model);this.$el.prop("checked",val);return this;},enterOrExitEditMode:function(e){if(!this.mouseDown){var model=this.model;model.trigger("backgrid:edited",model,this.column,new Command(e));}},saveOrCancel:function(e){var model=this.model;var column=this.column;var formatter=this.formatter;var command=new Command(e);if(command.passThru()&&e.type!="change")return true;if(command.cancel()){e.stopPropagation();model.trigger("backgrid:edited",model,column,command);}
var $el=this.$el;if(command.save()||command.moveLeft()||command.moveRight()||command.moveUp()||command.moveDown()){e.preventDefault();e.stopPropagation();var val=formatter.toRaw($el.prop("checked"),model);model.set(column.get("name"),val);model.trigger("backgrid:edited",model,column,command);}
else if(e.type=="change"){var val=formatter.toRaw($el.prop("checked"),model);model.set(column.get("name"),val);$el.focus();}}});var BooleanCell=Backgrid.BooleanCell=Cell.extend({className:"boolean-cell",editor:BooleanCellEditor,events:{"click":"enterEditMode"},render:function(){this.$el.empty();var model=this.model,column=this.column;var editable=Backgrid.callByNeed(column.editable(),column,model);this.$el.append($("<input>",{tabIndex:-1,type:"checkbox",checked:this.formatter.fromRaw(model.get(column.get("name")),model),disabled:!editable}));this.delegateEvents();return this;}});var SelectCellEditor=Backgrid.SelectCellEditor=CellEditor.extend({tagName:"select",events:{"change":"save","blur":"close","keydown":"close"},template:_.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %></option>',null,{variable:null,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}),setOptionValues:function(optionValues){this.optionValues=optionValues;this.optionValues=_.result(this,"optionValues");},setMultiple:function(multiple){this.multiple=multiple;this.$el.prop("multiple",multiple);},_renderOptions:function(nvps,selectedValues){var options='';for(var i=0;i<nvps.length;i++){options=options+this.template({text:nvps[i][0],value:nvps[i][1],selected:_.indexOf(selectedValues,nvps[i][1])>-1});}
return options;},render:function(){this.$el.empty();var optionValues=_.result(this,"optionValues");var model=this.model;var selectedValues=this.formatter.fromRaw(model.get(this.column.get("name")),model);if(!_.isArray(optionValues))throw new TypeError("optionValues must be an array");var optionValue=null;var optionText=null;var optionValue=null;var optgroupName=null;var optgroup=null;for(var i=0;i<optionValues.length;i++){var optionValue=optionValues[i];if(_.isArray(optionValue)){optionText=optionValue[0];optionValue=optionValue[1];this.$el.append(this.template({text:optionText,value:optionValue,selected:_.indexOf(selectedValues,optionValue)>-1}));}
else if(_.isObject(optionValue)){optgroupName=optionValue.name;optgroup=$("<optgroup></optgroup>",{label:optgroupName});optgroup.append(this._renderOptions.call(this,optionValue.values,selectedValues));this.$el.append(optgroup);}
else{throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");}}
this.delegateEvents();return this;},save:function(e){var model=this.model;var column=this.column;model.set(column.get("name"),this.formatter.toRaw(this.$el.val(),model));},close:function(e){var model=this.model;var column=this.column;var command=new Command(e);if(command.cancel()){e.stopPropagation();model.trigger("backgrid:edited",model,column,new Command(e));}
else if(command.save()||command.moveLeft()||command.moveRight()||command.moveUp()||command.moveDown()||e.type=="blur"){e.preventDefault();e.stopPropagation();this.save(e);model.trigger("backgrid:edited",model,column,new Command(e));}}});var SelectCell=Backgrid.SelectCell=Cell.extend({className:"select-cell",editor:SelectCellEditor,multiple:false,formatter:SelectFormatter,optionValues:undefined,delimiter:', ',initialize:function(options){SelectCell.__super__.initialize.apply(this,arguments);this.listenTo(this.model,"backgrid:edit",function(model,column,cell,editor){if(column.get("name")==this.column.get("name")){editor.setOptionValues(this.optionValues);editor.setMultiple(this.multiple);}});},render:function(){this.$el.empty();var optionValues=_.result(this,"optionValues");var model=this.model;var rawData=this.formatter.fromRaw(model.get(this.column.get("name")),model);var selectedText=[];try{if(!_.isArray(optionValues)||_.isEmpty(optionValues))throw new TypeError;for(var k=0;k<rawData.length;k++){var rawDatum=rawData[k];for(var i=0;i<optionValues.length;i++){var optionValue=optionValues[i];if(_.isArray(optionValue)){var optionText=optionValue[0];var optionValue=optionValue[1];if(optionValue==rawDatum)selectedText.push(optionText);}
else if(_.isObject(optionValue)){var optionGroupValues=optionValue.values;for(var j=0;j<optionGroupValues.length;j++){var optionGroupValue=optionGroupValues[j];if(optionGroupValue[1]==rawDatum){selectedText.push(optionGroupValue[0]);}}}
else{throw new TypeError;}}}
this.$el.append(selectedText.join(this.delimiter));}
catch(ex){if(ex instanceof TypeError){throw new TypeError("'optionValues' must be of type {Array.<Array>|Array.<{name: string, values: Array.<Array>}>}");}
throw ex;}
this.delegateEvents();return this;}});var Column=Backgrid.Column=Backbone.Model.extend({defaults:{name:undefined,label:undefined,sortable:true,editable:true,renderable:true,formatter:undefined,sortType:"cycle",sortValue:undefined,direction:null,cell:undefined,headerCell:undefined},initialize:function(){if(!this.has("label")){this.set({label:this.get("name")},{silent:true});}
var headerCell=Backgrid.resolveNameToClass(this.get("headerCell"),"HeaderCell");var cell=Backgrid.resolveNameToClass(this.get("cell"),"Cell");this.set({cell:cell,headerCell:headerCell},{silent:true});},sortValue:function(){var sortValue=this.get("sortValue");if(_.isString(sortValue))return this[sortValue];else if(_.isFunction(sortValue))return sortValue;return function(model,colName){return model.get(colName);};}});_.each(["sortable","renderable","editable"],function(key){Column.prototype[key]=function(){var value=this.get(key);if(_.isString(value))return this[value];else if(_.isFunction(value))return value;return!!value;};});var Columns=Backgrid.Columns=Backbone.Collection.extend({model:Column});var Row=Backgrid.Row=Backbone.View.extend({tagName:"tr",initialize:function(options){var columns=this.columns=options.columns;if(!(columns instanceof Backbone.Collection)){columns=this.columns=new Columns(columns);}
var cells=this.cells=[];for(var i=0;i<columns.length;i++){cells.push(this.makeCell(columns.at(i),options));}
this.listenTo(columns,"add",function(column,columns){var i=columns.indexOf(column);var cell=this.makeCell(column,options);cells.splice(i,0,cell);var $el=this.$el;if(i===0){$el.prepend(cell.render().$el);}
else if(i===columns.length-1){$el.append(cell.render().$el);}
else{$el.children().eq(i).before(cell.render().$el);}});this.listenTo(columns,"remove",function(column,columns,opts){cells[opts.index].remove();cells.splice(opts.index,1);});},makeCell:function(column){return new(column.get("cell"))({column:column,model:this.model});},render:function(){this.$el.empty();var fragment=document.createDocumentFragment();for(var i=0;i<this.cells.length;i++){fragment.appendChild(this.cells[i].render().el);}
this.el.appendChild(fragment);this.delegateEvents();return this;},remove:function(){for(var i=0;i<this.cells.length;i++){var cell=this.cells[i];cell.remove.apply(cell,arguments);}
return Backbone.View.prototype.remove.apply(this,arguments);}});var EmptyRow=Backgrid.EmptyRow=Backbone.View.extend({tagName:"tr",emptyText:null,initialize:function(options){this.emptyText=options.emptyText;this.columns=options.columns;},render:function(){this.$el.empty();var td=document.createElement("td");td.setAttribute("colspan",this.columns.length);var span=document.createElement("span");span.innerHTML=_.result(this,"emptyText");td.appendChild(span);this.el.className="empty";this.el.appendChild(td);return this;}});var HeaderCell=Backgrid.HeaderCell=Backbone.View.extend({tagName:"th",events:{"click button":"onClick"},initialize:function(options){this.column=options.column;if(!(this.column instanceof Column)){this.column=new Column(this.column);}
var column=this.column,collection=this.collection,$el=this.$el;this.listenTo(column,"change:editable change:sortable change:renderable",function(column){var changed=column.changedAttributes();for(var key in changed){if(changed.hasOwnProperty(key)){$el.toggleClass(key,changed[key]);}}});this.listenTo(column,"change:direction",this.setCellDirection);this.listenTo(column,"change:name change:label",this.render);if(Backgrid.callByNeed(column.editable(),column,collection))$el.addClass("editable");if(Backgrid.callByNeed(column.sortable(),column,collection))$el.addClass("sortable");if(Backgrid.callByNeed(column.renderable(),column,collection))$el.addClass("renderable");this.listenTo(collection.fullCollection||collection,"backgrid:sorted",this.removeCellDirection);},removeCellDirection:function(){this.$el.removeClass("ascending").removeClass("descending");this.column.set("direction",null);},setCellDirection:function(column,direction){this.$el.removeClass("ascending").removeClass("descending");if(column.cid==this.column.cid)this.$el.addClass(direction);},onClick:function(e){e.preventDefault();var column=this.column;var collection=this.collection;var event="backgrid:sort";function cycleSort(header,col){if(column.get("direction")==="ascending")collection.trigger(event,col,"descending");else if(column.get("direction")==="descending")collection.trigger(event,col,null);else collection.trigger(event,col,"ascending");}
function toggleSort(header,col){if(column.get("direction")==="ascending")collection.trigger(event,col,"descending");else collection.trigger(event,col,"ascending");}
var sortable=Backgrid.callByNeed(column.sortable(),column,this.collection);if(sortable){var sortType=column.get("sortType");if(sortType==="toggle")toggleSort(this,column);else cycleSort(this,column);}},render:function(){this.$el.empty();var column=this.column;var sortable=Backgrid.callByNeed(column.sortable(),column,this.collection);var label;if(sortable){label=$("<button>").text(column.get("label")).append("<span class='sort-caret' aria-hidden='true'></span>");}else{label=document.createTextNode(column.get("label"));}
this.$el.append(label);this.$el.addClass(column.get("name"));this.$el.addClass(column.get("direction"));this.delegateEvents();return this;}});var HeaderRow=Backgrid.HeaderRow=Backgrid.Row.extend({initialize:function(){Backgrid.Row.prototype.initialize.apply(this,arguments);},makeCell:function(column,options){var headerCell=column.get("headerCell")||options.headerCell||HeaderCell;headerCell=new headerCell({column:column,collection:this.collection});return headerCell;}});var Header=Backgrid.Header=Backbone.View.extend({tagName:"thead",initialize:function(options){this.columns=options.columns;if(!(this.columns instanceof Backbone.Collection)){this.columns=new Columns(this.columns);}
this.row=new Backgrid.HeaderRow({columns:this.columns,collection:this.collection});},render:function(){this.$el.append(this.row.render().$el);this.delegateEvents();return this;},remove:function(){this.row.remove.apply(this.row,arguments);return Backbone.View.prototype.remove.apply(this,arguments);}});var Body=Backgrid.Body=Backbone.View.extend({tagName:"tbody",initialize:function(options){this.columns=options.columns;if(!(this.columns instanceof Backbone.Collection)){this.columns=new Columns(this.columns);}
this.row=options.row||this.row||Row;this.rows=this.collection.map(function(model){var row=new this.row({columns:this.columns,model:model});return row;},this);this.emptyText=options.emptyText;this._unshiftEmptyRowMayBe();var collection=this.collection;this.listenTo(collection,"add",this.insertRow);this.listenTo(collection,"remove",this.removeRow);this.listenTo(collection,"sort",this.refresh);this.listenTo(collection,"reset",this.refresh);this.listenTo(collection,"backgrid:sort",this.sort);this.listenTo(collection,"backgrid:edited",this.moveToNextCell);this.listenTo(this.columns,"add remove",this.updateEmptyRow);},_unshiftEmptyRowMayBe:function(){if(this.rows.length===0&&this.emptyText!=null){this.emptyRow=new EmptyRow({emptyText:this.emptyText,columns:this.columns});this.rows.unshift(this.emptyRow);return true}},insertRow:function(model,collection,options){if(this.rows[0]instanceof EmptyRow)this.rows.pop().remove();if(!(collection instanceof Backbone.Collection)&&!options){this.collection.add(model,(options=collection));return;}
var row=new this.row({columns:this.columns,model:model});var index=collection.indexOf(model);this.rows.splice(index,0,row);var $el=this.$el;var $children=$el.children();var $rowEl=row.render().$el;if(index>=$children.length){$el.append($rowEl);}
else{$children.eq(index).before($rowEl);}
return this;},removeRow:function(model,collection,options){if(!options){this.collection.remove(model,(options=collection));if(this._unshiftEmptyRowMayBe()){this.render();}
return;}
if(_.isUndefined(options.render)||options.render){this.rows[options.index].remove();}
this.rows.splice(options.index,1);if(this._unshiftEmptyRowMayBe()){this.render();}
return this;},updateEmptyRow:function(){if(this.emptyRow!=null){this.emptyRow.render();}},refresh:function(){for(var i=0;i<this.rows.length;i++){this.rows[i].remove();}
this.rows=this.collection.map(function(model){var row=new this.row({columns:this.columns,model:model});return row;},this);this._unshiftEmptyRowMayBe();this.render();this.collection.trigger("backgrid:refresh",this);return this;},render:function(){this.$el.empty();var fragment=document.createDocumentFragment();for(var i=0;i<this.rows.length;i++){var row=this.rows[i];fragment.appendChild(row.render().el);}
this.el.appendChild(fragment);this.delegateEvents();return this;},remove:function(){for(var i=0;i<this.rows.length;i++){var row=this.rows[i];row.remove.apply(row,arguments);}
return Backbone.View.prototype.remove.apply(this,arguments);},sort:function(column,direction){if(!_.contains(["ascending","descending",null],direction)){throw new RangeError('direction must be one of "ascending", "descending" or `null`');}
if(_.isString(column))column=this.columns.findWhere({name:column});var collection=this.collection;var order;if(direction==="ascending")order=-1;else if(direction==="descending")order=1;else order=null;var comparator=this.makeComparator(column.get("name"),order,order?column.sortValue():function(model){return model.cid.replace('c','')*1;});if(Backbone.PageableCollection&&collection instanceof Backbone.PageableCollection){collection.setSorting(order&&column.get("name"),order,{sortValue:column.sortValue()});if(collection.fullCollection){if(collection.fullCollection.comparator==null){collection.fullCollection.comparator=comparator;}
collection.fullCollection.sort();collection.trigger("backgrid:sorted",column,direction,collection);column.set("direction",direction);}
else collection.fetch({reset:true,success:function(){collection.trigger("backgrid:sorted",column,direction,collection);column.set("direction",direction);}});}
else{collection.comparator=comparator;collection.sort();collection.trigger("backgrid:sorted",column,direction,collection);column.set("direction",direction);}
return this;},makeComparator:function(attr,order,func){return function(left,right){var l=func(left,attr),r=func(right,attr),t;if(order===1)t=l,l=r,r=t;if(l===r)return 0;else if(l<r)return-1;return 1;};},moveToNextCell:function(model,column,command){var i=this.collection.indexOf(model);var j=this.columns.indexOf(column);var cell,renderable,editable,m,n;if(j===-1)return this;this.rows[i].cells[j].exitEditMode();if(command.moveUp()||command.moveDown()||command.moveLeft()||command.moveRight()||command.save()){var l=this.columns.length;var maxOffset=l*this.collection.length;if(command.moveUp()||command.moveDown()){m=i+(command.moveUp()?-1:1);var row=this.rows[m];if(row){cell=row.cells[j];if(Backgrid.callByNeed(cell.column.editable(),cell.column,model)){cell.enterEditMode();model.trigger("backgrid:next",m,j,false);}}
else model.trigger("backgrid:next",m,j,true);}
else if(command.moveLeft()||command.moveRight()){var right=command.moveRight();for(var offset=i*l+j+(right?1:-1);offset>=0&&offset<maxOffset;right?offset++:offset--){m=~~(offset/l);n=offset-m*l;cell=this.rows[m].cells[n];renderable=Backgrid.callByNeed(cell.column.renderable(),cell.column,cell.model);editable=Backgrid.callByNeed(cell.column.editable(),cell.column,model);if(renderable&&editable){cell.enterEditMode();model.trigger("backgrid:next",m,n,false);break;}}
if(offset==maxOffset){model.trigger("backgrid:next",~~(offset/l),offset-m*l,true);}}}
return this;}});var Footer=Backgrid.Footer=Backbone.View.extend({tagName:"tfoot",initialize:function(options){this.columns=options.columns;if(!(this.columns instanceof Backbone.Collection)){this.columns=new Backgrid.Columns(this.columns);}}});var Grid=Backgrid.Grid=Backbone.View.extend({tagName:"table",className:"backgrid",header:Header,body:Body,footer:null,initialize:function(options){if(!(options.columns instanceof Backbone.Collection)){options.columns=new Columns(options.columns||this.columns);}
this.columns=options.columns;this.caption=options.caption;var filteredOptions=_.omit(options,["el","id","attributes","className","tagName","events"]);this.body=options.body||this.body;this.body=new this.body(filteredOptions);this.header=options.header||this.header;if(this.header){this.header=new this.header(filteredOptions);}
this.footer=options.footer||this.footer;if(this.footer){this.footer=new this.footer(filteredOptions);}
this.listenTo(this.columns,"reset",function(){if(this.header){this.header=new(this.header.remove().constructor)(filteredOptions);}
this.body=new(this.body.remove().constructor)(filteredOptions);if(this.footer){this.footer=new(this.footer.remove().constructor)(filteredOptions);}
this.render();});},insertRow:function(){this.body.insertRow.apply(this.body,arguments);return this;},removeRow:function(){this.body.removeRow.apply(this.body,arguments);return this;},insertColumn:function(){this.columns.add.apply(this.columns,arguments);return this;},removeColumn:function(){this.columns.remove.apply(this.columns,arguments);return this;},sort:function(){this.body.sort.apply(this.body,arguments);return this;},render:function(){this.$el.empty();if(this.caption){this.$el.append($("<caption>").text(this.caption));}
if(this.header){this.$el.append(this.header.render().$el);}
if(this.footer){this.$el.append(this.footer.render().$el);}
this.$el.append(this.body.render().$el);this.delegateEvents();this.trigger("backgrid:rendered",this);return this;},remove:function(){this.header&&this.header.remove.apply(this.header,arguments);this.body.remove.apply(this.body,arguments);this.footer&&this.footer.remove.apply(this.footer,arguments);return Backbone.View.prototype.remove.apply(this,arguments);}});return Backgrid;}));
// js/3rd/backbone/backbone.paginator.js
(function(factory){if(typeof exports=="object"&&typeof require=="function"){module.exports=factory(require("underscore"),require("backbone"));}
else if(typeof define=="function"&&define.amd){define(["underscore","backbone"],factory);}
else if(typeof _!=="undefined"&&typeof Backbone!=="undefined"){var oldPageableCollection=Backbone.PageableCollection;var PageableCollection=factory(_,Backbone);Backbone.PageableCollection.noConflict=function(){Backbone.PageableCollection=oldPageableCollection;return PageableCollection;};}}(function(_,Backbone){"use strict";var _extend=_.extend;var _omit=_.omit;var _clone=_.clone;var _each=_.each;var _pick=_.pick;var _contains=_.includes;var _isEmpty=_.isEmpty;var _pairs=_.pairs||_.toPairs;var _invert=_.invert;var _isArray=_.isArray;var _isFunction=_.isFunction;var _isObject=_.isObject;var _keys=_.keys;var _isUndefined=_.isUndefined;var ceil=Math.ceil;var floor=Math.floor;var max=Math.max;var BBColProto=Backbone.Collection.prototype;function finiteInt(val,name){if(!_.isNumber(val)||_.isNaN(val)||!_.isFinite(val)||~~val!==val){throw new TypeError("`"+name+"` must be a finite integer");}
return val;}
function queryStringToParams(qs){var kvp,k,v,ls,params={},decode=decodeURIComponent;var kvps=qs.split("&");for(var i=0,l=kvps.length;i<l;i++){var param=kvps[i];kvp=param.split("="),k=kvp[0],v=kvp[1];if(v==null)v=true;k=decode(k),v=decode(v),ls=params[k];if(_isArray(ls))ls.push(v);else if(ls)params[k]=[ls,v];else params[k]=v;}
return params;}
function runOnceAtLastHandler(col,event,func){var eventHandlers=col._events[event];if(eventHandlers&&eventHandlers.length){var lastHandler=eventHandlers[eventHandlers.length-1];var oldCallback=lastHandler.callback;lastHandler.callback=function(){try{oldCallback.apply(this,arguments);func();}
catch(e){throw e;}
finally{lastHandler.callback=oldCallback;}};}
else func();}
var PARAM_TRIM_RE=/[\s'"]/g;var URL_TRIM_RE=/[<>\s'"]/g;var PageableCollection=Backbone.PageableCollection=Backbone.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc","1":"desc"}},constructor:function(models,options){BBColProto.constructor.apply(this,arguments);options=options||{};var mode=this.mode=options.mode||this.mode||PageableProto.mode;var queryParams=_extend({},PageableProto.queryParams,this.queryParams,options.queryParams||{});queryParams.directions=_extend({},PageableProto.queryParams.directions,this.queryParams.directions,queryParams.directions);this.queryParams=queryParams;var state=this.state=_extend({},PageableProto.state,this.state,options.state);state.currentPage=state.currentPage==null?state.firstPage:state.currentPage;if(!_isArray(models))models=models?[models]:[];models=models.slice();if(mode!="server"&&state.totalRecords==null&&!_isEmpty(models)){state.totalRecords=this.length;}
this.switchMode(mode,_extend({fetch:false,resetState:false,models:models},options));var comparator=options.comparator;if(state.sortKey&&!comparator){this.setSorting(state.sortKey,state.order,options);}
if(mode!="server"){var fullCollection=this.fullCollection;if(comparator&&options.full){this.comparator=null;fullCollection.comparator=comparator;}
if(options.full)fullCollection.sort();if(!_isEmpty(models)){this.getPage(state.currentPage);}}
this._initState=_clone(this.state);},_makeFullCollection:function(models,options){var properties=["url","model","sync","comparator"];var thisProto=this.constructor.prototype;var i,length,prop;var proto={};for(i=0,length=properties.length;i<length;i++){prop=properties[i];if(!_isUndefined(thisProto[prop])){proto[prop]=thisProto[prop];}}
var fullCollection=new(Backbone.Collection.extend(proto))(models,options);for(i=0,length=properties.length;i<length;i++){prop=properties[i];if(this[prop]!==thisProto[prop]){fullCollection[prop]=this[prop];}}
return fullCollection;},_makeCollectionEventHandler:function(pageCol,fullCol){return function collectionEventHandler(event,model,collection,options){var handlers=pageCol._handlers;_each(_keys(handlers),function(event){var handler=handlers[event];pageCol.off(event,handler);fullCol.off(event,handler);});var state=_clone(pageCol.state);var firstPage=state.firstPage;var currentPage=firstPage===0?state.currentPage:state.currentPage-1;var pageSize=state.pageSize;var pageStart=currentPage*pageSize,pageEnd=pageStart+pageSize;if(event=="add"){var pageIndex,fullIndex,addAt,colToAdd,options=options||{};if(collection==fullCol){fullIndex=fullCol.indexOf(model);if(fullIndex>=pageStart&&fullIndex<pageEnd){colToAdd=pageCol;pageIndex=addAt=fullIndex-pageStart;}}
else{pageIndex=pageCol.indexOf(model);fullIndex=pageStart+pageIndex;colToAdd=fullCol;var addAt=!_isUndefined(options.at)?options.at+pageStart:fullIndex;}
if(!options.onRemove){++state.totalRecords;delete options.onRemove;}
pageCol.state=pageCol._checkState(state);if(colToAdd){colToAdd.add(model,_extend({},options,{at:addAt}));var modelToRemove=pageIndex>=pageSize?model:!_isUndefined(options.at)&&addAt<pageEnd&&pageCol.length>pageSize?pageCol.at(pageSize):null;if(modelToRemove){runOnceAtLastHandler(collection,event,function(){pageCol.remove(modelToRemove,{onAdd:true});});}}
if(!options.silent)pageCol.trigger("pageable:state:change",pageCol.state);}
if(event=="remove"){if(!options.onAdd){if(!--state.totalRecords){state.totalRecords=null;state.totalPages=null;}
else{var totalPages=state.totalPages=ceil(state.totalRecords/pageSize);state.lastPage=firstPage===0?totalPages-1:totalPages||firstPage;if(state.currentPage>totalPages)state.currentPage=state.lastPage;}
pageCol.state=pageCol._checkState(state);var nextModel,removedIndex=options.index;if(collection==pageCol){if(nextModel=fullCol.at(pageEnd)){runOnceAtLastHandler(pageCol,event,function(){pageCol.push(nextModel,{onRemove:true});});}
else if(!pageCol.length&&state.totalRecords){pageCol.reset(fullCol.models.slice(pageStart-pageSize,pageEnd-pageSize),_extend({},options,{parse:false}));}
fullCol.remove(model);}
else if(removedIndex>=pageStart&&removedIndex<pageEnd){if(nextModel=fullCol.at(pageEnd-1)){runOnceAtLastHandler(pageCol,event,function(){pageCol.push(nextModel,{onRemove:true});});}
pageCol.remove(model);if(!pageCol.length&&state.totalRecords){pageCol.reset(fullCol.models.slice(pageStart-pageSize,pageEnd-pageSize),_extend({},options,{parse:false}));}}}
else delete options.onAdd;if(!options.silent)pageCol.trigger("pageable:state:change",pageCol.state);}
if(event=="reset"){options=collection;collection=model;if(collection==pageCol&&options.from==null&&options.to==null){var head=fullCol.models.slice(0,pageStart);var tail=fullCol.models.slice(pageStart+pageCol.models.length);fullCol.reset(head.concat(pageCol.models).concat(tail),options);}
else if(collection==fullCol){if(!(state.totalRecords=fullCol.models.length)){state.totalRecords=null;state.totalPages=null;}
if(pageCol.mode=="client"){firstPage=state.lastPage=state.currentPage=state.firstPage;currentPage=firstPage===0?state.currentPage:state.currentPage-1;pageStart=currentPage*pageSize;pageEnd=pageStart+pageSize;}
pageCol.state=pageCol._checkState(state);pageCol.reset(fullCol.models.slice(pageStart,pageEnd),_extend({},options,{parse:false}));}
if(!options.silent)pageCol.trigger("pageable:state:change",pageCol.state);}
if(event=="sort"){options=collection;collection=model;if(collection===fullCol){pageCol.reset(fullCol.models.slice(pageStart,pageEnd),_extend({},options,{parse:false}));}}
_each(_keys(handlers),function(event){var handler=handlers[event];_each([pageCol,fullCol],function(col){col.on(event,handler);var callbacks=col._events[event]||[];callbacks.unshift(callbacks.pop());});});};},_checkState:function(state){var mode=this.mode;var links=this.links;var totalRecords=state.totalRecords;var pageSize=state.pageSize;var currentPage=state.currentPage;var firstPage=state.firstPage;var totalPages=state.totalPages;if(totalRecords!=null&&pageSize!=null&&currentPage!=null&&firstPage!=null&&(mode=="infinite"?links:true)){totalRecords=finiteInt(totalRecords,"totalRecords");pageSize=finiteInt(pageSize,"pageSize");currentPage=finiteInt(currentPage,"currentPage");firstPage=finiteInt(firstPage,"firstPage");if(pageSize<1){throw new RangeError("`pageSize` must be >= 1");}
totalPages=state.totalPages=ceil(totalRecords/pageSize);if(firstPage<0||firstPage>1){throw new RangeError("`firstPage must be 0 or 1`");}
state.lastPage=firstPage===0?max(0,totalPages-1):totalPages||firstPage;if(mode=="infinite"){if(!links[currentPage]){throw new RangeError("No link found for page "+currentPage);}}
else if(currentPage<firstPage||(totalPages>0&&(firstPage?currentPage>totalPages:currentPage>=totalPages))){throw new RangeError("`currentPage` must be firstPage <= currentPage "+
(firstPage?"<":"<=")+" totalPages if "+firstPage+"-based. Got "+
currentPage+".");}}
return state;},setPageSize:function(pageSize,options){pageSize=finiteInt(pageSize,"pageSize");options=options||{first:false};var state=this.state;var totalPages=ceil(state.totalRecords/pageSize);var currentPage=totalPages?max(state.firstPage,floor(totalPages*state.currentPage/state.totalPages)):state.firstPage;state=this.state=this._checkState(_extend({},state,{pageSize:pageSize,currentPage:options.first?state.firstPage:currentPage,totalPages:totalPages}));return this.getPage(state.currentPage,_omit(options,["first"]));},switchMode:function(mode,options){if(!_contains(["server","client","infinite"],mode)){throw new TypeError('`mode` must be one of "server", "client" or "infinite"');}
options=options||{fetch:true,resetState:true};var state=this.state=options.resetState?_clone(this._initState):this._checkState(_extend({},this.state));this.mode=mode;var self=this;var fullCollection=this.fullCollection;var handlers=this._handlers=this._handlers||{},handler;if(mode!="server"&&!fullCollection){fullCollection=this._makeFullCollection(options.models||[],options);fullCollection.pageableCollection=this;this.fullCollection=fullCollection;var allHandler=this._makeCollectionEventHandler(this,fullCollection);_each(["add","remove","reset","sort"],function(event){handlers[event]=handler=_.bind(allHandler,{},event);self.on(event,handler);fullCollection.on(event,handler);});fullCollection.comparator=this._fullComparator;}
else if(mode=="server"&&fullCollection){_each(_keys(handlers),function(event){handler=handlers[event];self.off(event,handler);fullCollection.off(event,handler);});delete this._handlers;this._fullComparator=fullCollection.comparator;delete this.fullCollection;}
if(mode=="infinite"){var links=this.links={};var firstPage=state.firstPage;var totalPages=ceil(state.totalRecords/state.pageSize);var lastPage=firstPage===0?max(0,totalPages-1):totalPages||firstPage;for(var i=state.firstPage;i<=lastPage;i++){links[i]=this.url;}}
else if(this.links)delete this.links;if(!options.silent)this.trigger("pageable:state:change",state);return options.fetch?this.fetch(_omit(options,"fetch","resetState")):this;},hasPreviousPage:function(){var state=this.state;var currentPage=state.currentPage;if(this.mode!="infinite")return currentPage>state.firstPage;return!!this.links[currentPage-1];},hasNextPage:function(){var state=this.state;var currentPage=this.state.currentPage;if(this.mode!="infinite")return currentPage<state.lastPage;return!!this.links[currentPage+1];},getFirstPage:function(options){return this.getPage("first",options);},getPreviousPage:function(options){return this.getPage("prev",options);},getNextPage:function(options){return this.getPage("next",options);},getLastPage:function(options){return this.getPage("last",options);},getPage:function(index,options){var mode=this.mode,fullCollection=this.fullCollection;options=options||{fetch:false};var state=this.state,firstPage=state.firstPage,currentPage=state.currentPage,lastPage=state.lastPage,pageSize=state.pageSize;var pageNum=index;switch(index){case"first":pageNum=firstPage;break;case"prev":pageNum=currentPage-1;break;case"next":pageNum=currentPage+1;break;case"last":pageNum=lastPage;break;default:pageNum=finiteInt(index,"index");}
this.state=this._checkState(_extend({},state,{currentPage:pageNum}));if(!options.silent)this.trigger("pageable:state:change",this.state);options.from=currentPage,options.to=pageNum;var pageStart=(firstPage===0?pageNum:pageNum-1)*pageSize;var pageModels=fullCollection&&fullCollection.length?fullCollection.models.slice(pageStart,pageStart+pageSize):[];if((mode=="client"||(mode=="infinite"&&!_isEmpty(pageModels)))&&!options.fetch){this.reset(pageModels,_omit(options,"fetch"));return this;}
if(mode=="infinite")options.url=this.links[pageNum];return this.fetch(_omit(options,"fetch"));},getPageByOffset:function(offset,options){if(offset<0){throw new RangeError("`offset must be > 0`");}
offset=finiteInt(offset,"offset");var page=floor(offset/this.state.pageSize);if(this.state.firstPage!==0)page++;if(page>this.state.lastPage)page=this.state.lastPage;return this.getPage(page,options);},sync:function(method,model,options){var self=this;if(self.mode=="infinite"){var success=options.success;var currentPage=self.state.currentPage;options.success=function(resp,status,xhr){var links=self.links;var newLinks=self.parseLinks(resp,_extend({xhr:xhr},options));if(newLinks.first)links[self.state.firstPage]=newLinks.first;if(newLinks.prev)links[currentPage-1]=newLinks.prev;if(newLinks.next)links[currentPage+1]=newLinks.next;if(success)success(resp,status,xhr);};}
return(BBColProto.sync||Backbone.sync).call(self,method,model,options);},parseLinks:function(resp,options){var links={};var linkHeader=options.xhr.getResponseHeader("Link");if(linkHeader){var relations=["first","prev","next"];_each(linkHeader.split(","),function(linkValue){var linkParts=linkValue.split(";");var url=linkParts[0].replace(URL_TRIM_RE,"");var params=linkParts.slice(1);_each(params,function(param){var paramParts=param.split("=");var key=paramParts[0].replace(PARAM_TRIM_RE,"");var value=paramParts[1].replace(PARAM_TRIM_RE,"");if(key=="rel"&&_contains(relations,value))links[value]=url;});});}
return links;},parse:function(resp,options){var newState=this.parseState(resp,_clone(this.queryParams),_clone(this.state),options);if(newState){this.state=this._checkState(_extend({},this.state,newState));if(!(options||{}).silent)this.trigger("pageable:state:change",this.state);}
return this.parseRecords(resp,options);},parseState:function(resp,queryParams,state,options){if(resp&&resp.length===2&&_isObject(resp[0])&&_isArray(resp[1])){var newState=_clone(state);var serverState=resp[0];_each(_pairs(_omit(queryParams,"directions")),function(kvp){var k=kvp[0],v=kvp[1];var serverVal=serverState[v];if(!_isUndefined(serverVal)&&!_.isNull(serverVal))newState[k]=serverState[v];});if(serverState.order){newState.order=_invert(queryParams.directions)[serverState.order]*1;}
return newState;}},parseRecords:function(resp,options){if(resp&&resp.length===2&&_isObject(resp[0])&&_isArray(resp[1])){return resp[1];}
return resp;},fetch:function(options){options=options||{};var state=this._checkState(this.state);var mode=this.mode;if(mode=="infinite"&&!options.url){options.url=this.links[state.currentPage];}
var data=options.data||{};var url=options.url||this.url||"";if(_isFunction(url))url=url.call(this);var qsi=url.indexOf("?");if(qsi!=-1){_extend(data,queryStringToParams(url.slice(qsi+1)));url=url.slice(0,qsi);}
options.url=url;options.data=data;var queryParams=this.mode=="client"?_pick(this.queryParams,"sortKey"):_omit(_pick(this.queryParams,_keys(PageableProto.queryParams)),"order","directions","totalPages","totalRecords");_each(queryParams,function(v,k){v=_isFunction(v)?v.call(this):v;if(state[k]!=null&&v!=null&&_.isUndefined(data[v])){data[v]=state[k];}},this);var sortKey=_isFunction(this.queryParams.sortKey)?this.queryParams.sortKey.call(this):this.queryParams.sortKey;var order=_isFunction(this.queryParams.order)?this.queryParams.order.call(this):this.queryParams.order;if(sortKey!=null&&state.sortKey!=null&&order!=null&&state.order!=null){if(_isArray(state.order)){data[order]=[];for(var i=0;i<state.order.length;i++){data[order].push(this.queryParams.directions[state.order[i]]);}}
else{data[order]=this.queryParams.directions[state.order+""];}}
var extraKvps=_pairs(_omit(this.queryParams,_keys(PageableProto.queryParams)));for(var i=0;i<extraKvps.length;i++){var kvp=extraKvps[i];var v=kvp[1];v=_isFunction(v)?v.call(this):v;if(v!=null)data[kvp[0]]=v;}
if(mode!="server"){var self=this,fullCol=this.fullCollection;var success=options.success;options.success=function(col,resp,opts){opts=opts||{};if(_isUndefined(options.silent))delete opts.silent;else opts.silent=options.silent;var models=col.models;if(mode=="client")fullCol.reset(models,opts);else{fullCol.add(models,_extend({at:fullCol.length},_extend(opts,{parse:false})));self.trigger("reset",self,opts);}
if(success)success(col,resp,opts);};return BBColProto.fetch.call(this,_extend({},options,{silent:true}));}
return BBColProto.fetch.call(this,options);},_makeComparator:function(sortKey,order,sortValue){var state=this.state;sortKey=sortKey||state.sortKey;order=order||state.order;if(!sortKey||!order)return;if(!sortValue){sortValue=function(model,attr){return model.get(attr);};}
return function(left,right){var l=sortValue(left,sortKey),r=sortValue(right,sortKey),t;if(order===1)t=l,l=r,r=t;if(l===r)return 0;else if(l<r)return-1;return 1;};},setSorting:function(sortKey,order,options){var state=this.state;state.sortKey=sortKey;state.order=order=order||state.order;var fullCollection=this.fullCollection;var delComp=false,delFullComp=false;if(!sortKey)delComp=delFullComp=true;var mode=this.mode;options=_extend({side:mode=="client"?mode:"server",full:true},options);var comparator=this._makeComparator(sortKey,order,options.sortValue);var full=options.full,side=options.side;if(side=="client"){if(full){if(fullCollection)fullCollection.comparator=comparator;delComp=true;}
else{this.comparator=comparator;delFullComp=true;}}
else if(side=="server"&&!full){this.comparator=comparator;}
if(delComp)this.comparator=null;if(delFullComp&&fullCollection)fullCollection.comparator=null;return this;}});var PageableProto=PageableCollection.prototype;return PageableCollection;}));
// js/3rd/backbone/backgrid-paginator.js
(function(root,factory){if(typeof exports=="object"){module.exports=factory(require("underscore"),require("backbone"),require("backgrid"),require("backbone.paginator"));}
else if(typeof define=="function"&&define.amd){define(["underscore","backbone","backgrid","backbone.paginator"],factory);}
else{factory(root._,root.Backbone,root.Backgrid);}}(this,function(_,Backbone,Backgrid){"use strict";var PageHandle=Backgrid.Extension.PageHandle=Backbone.View.extend({tagName:"li",events:{"click a":"changePage"},title:function(data){return'Page '+data.label;},isRewind:false,isBack:false,isForward:false,isFastForward:false,initialize:function(options){var collection=this.collection;var state=collection.state;var currentPage=state.currentPage;var firstPage=state.firstPage;var lastPage=state.lastPage;_.extend(this,_.pick(options,["isRewind","isBack","isForward","isFastForward"]));var pageIndex;if(this.isRewind)pageIndex=firstPage;else if(this.isBack)pageIndex=Math.max(firstPage,currentPage-1);else if(this.isForward)pageIndex=Math.min(lastPage,currentPage+1);else if(this.isFastForward)pageIndex=lastPage;else{pageIndex=+options.pageIndex;pageIndex=(firstPage?pageIndex+1:pageIndex);}
this.pageIndex=pageIndex;this.label=(options.label||(firstPage?pageIndex:pageIndex+1))+'';var title=options.title||this.title;this.title=_.isFunction(title)?title({label:this.label}):title;},render:function(){this.$el.empty();var anchor=document.createElement("a");anchor.href='#';if(this.title)anchor.title=this.title;anchor.innerHTML=this.label;this.el.appendChild(anchor);var collection=this.collection;var state=collection.state;var currentPage=state.currentPage;var pageIndex=this.pageIndex;if(this.isRewind&&currentPage==state.firstPage||this.isBack&&!collection.hasPreviousPage()||this.isForward&&!collection.hasNextPage()||this.isFastForward&&(currentPage==state.lastPage||state.totalPages<1)){this.$el.addClass("disabled");}
else if(!(this.isRewind||this.isBack||this.isForward||this.isFastForward)&&state.currentPage==pageIndex){this.$el.addClass("active");}
this.delegateEvents();return this;},changePage:function(e){e.preventDefault();var $el=this.$el,col=this.collection;if(!$el.hasClass("active")&&!$el.hasClass("disabled")){if(this.isRewind)col.getFirstPage({reset:true});else if(this.isBack)col.getPreviousPage({reset:true});else if(this.isForward)col.getNextPage({reset:true});else if(this.isFastForward)col.getLastPage({reset:true});else col.getPage(this.pageIndex,{reset:true});}
return this;}});var Paginator=Backgrid.Extension.Paginator=Backbone.View.extend({className:"backgrid-paginator",windowSize:10,slideScale:0.5,controls:{rewind:{label:"",title:"First"},back:{label:"",title:"Previous"},forward:{label:"",title:"Next"},fastForward:{label:"",title:"Last"}},renderIndexedPageHandles:true,renderMultiplePagesOnly:false,pageHandle:PageHandle,goBackFirstOnSort:true,initialize:function(options){var self=this;self.controls=_.defaults(options.controls||{},self.controls,Paginator.prototype.controls);_.extend(self,_.pick(options||{},"windowSize","pageHandle","slideScale","goBackFirstOnSort","renderIndexedPageHandles","renderMultiplePagesOnly"));var col=self.collection;self.listenTo(col,"add",self.render);self.listenTo(col,"remove",self.render);self.listenTo(col,"reset",self.render);self.listenTo(col,"backgrid:sorted",function(){if(self.goBackFirstOnSort&&col.state.currentPage!==col.state.firstPage)col.getFirstPage({reset:true});});},slideMaybe:function(firstPage,lastPage,currentPage,windowSize,slideScale){return Math.round(currentPage%windowSize/windowSize);},slideThisMuch:function(firstPage,lastPage,currentPage,windowSize,slideScale){return~~(windowSize*slideScale);},_calculateWindow:function(){var collection=this.collection;var state=collection.state;var firstPage=state.firstPage;var lastPage=+state.lastPage;lastPage=Math.max(0,firstPage?lastPage-1:lastPage);var currentPage=Math.max(state.currentPage,state.firstPage);currentPage=firstPage?currentPage-1:currentPage;var windowSize=this.windowSize;var slideScale=this.slideScale;var windowStart=Math.floor(currentPage/windowSize)*windowSize;if(currentPage<=lastPage-this.slideThisMuch()){windowStart+=(this.slideMaybe(firstPage,lastPage,currentPage,windowSize,slideScale)*this.slideThisMuch(firstPage,lastPage,currentPage,windowSize,slideScale));}
var windowEnd=Math.min(lastPage+1,windowStart+windowSize);return[windowStart,windowEnd];},makeHandles:function(){var handles=[];var collection=this.collection;var window=this._calculateWindow();var winStart=window[0],winEnd=window[1];if(this.renderIndexedPageHandles){for(var i=winStart;i<winEnd;i++){handles.push(new this.pageHandle({collection:collection,pageIndex:i}));}}
var controls=this.controls;_.each(["back","rewind","forward","fastForward"],function(key){var value=controls[key];if(value){var handleCtorOpts={collection:collection,title:value.title,label:value.label};handleCtorOpts["is"+key.slice(0,1).toUpperCase()+key.slice(1)]=true;var handle=new this.pageHandle(handleCtorOpts);if(key=="rewind"||key=="back")handles.unshift(handle);else handles.push(handle);}},this);return handles;},render:function(){this.$el.empty();var totalPages=this.collection.state.totalPages;if(this.renderMultiplePagesOnly&&totalPages<=1){return this;}
if(this.handles){for(var i=0,l=this.handles.length;i<l;i++){this.handles[i].remove();}}
var handles=this.handles=this.makeHandles();var ul=document.createElement("ul");for(var i=0;i<handles.length;i++){ul.appendChild(handles[i].render().el);}
this.el.appendChild(ul);return this;}});}));
// js/3rd/json/json2.js
if(typeof JSON!=='object'){JSON={};}
(function(){'use strict';function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}}());
